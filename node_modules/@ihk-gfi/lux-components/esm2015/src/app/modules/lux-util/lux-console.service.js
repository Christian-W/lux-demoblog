import * as tslib_1 from "tslib";
var LuxConsoleService_1;
import { Injectable } from '@angular/core';
import { environment } from '../../../environments/environment';
import { LuxComponentsConfigService } from '../lux-components-config/lux-components-config.service';
import * as i0 from "@angular/core";
import * as i1 from "../lux-components-config/lux-components-config.service";
export const noop = () => undefined;
let LuxConsoleService = LuxConsoleService_1 = class LuxConsoleService {
    constructor(componentsConfigService) {
        // Aus der Konfiguration die Info erhalten, ob Logs angezeigt werden sollen
        componentsConfigService.config.subscribe((newConfig) => {
            LuxConsoleService_1.config = newConfig;
        });
    }
    /* Nicht-statische Log-Methoden, sie zeigen auch die Quelle des Logs an! */
    get log() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.log.bind.call(console.log, console, LuxConsoleService_1.logDate() + ' -');
        }
        else {
            return noop;
        }
    }
    get warn() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.warn.bind.call(console.warn, console, LuxConsoleService_1.logDate() + ' -');
        }
        else {
            return noop;
        }
    }
    get error() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.error.bind.call(console.error, console, LuxConsoleService_1.logDate() + ' -');
        }
        else {
            return noop;
        }
    }
    get group() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.group.bind.call(console.group, console);
        }
        else {
            return noop;
        }
    }
    get info() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.info.bind.call(console.info, console);
        }
        else {
            return noop;
        }
    }
    get groupEnd() {
        if (LuxConsoleService_1.isDebugMode()) {
            return console.groupEnd.bind.call(console.groupEnd, console);
        }
        else {
            return noop;
        }
    }
    /* Statische Log-Methoden, sie zeigen nicht die Quelle des Logs an! */
    static LOG(...args) {
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.log(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.log(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.log(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    }
    static WARN(...args) {
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.warn(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.warn(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.warn(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    }
    static ERROR(...args) {
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.error(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.error(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.error(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    }
    static logDate() {
        const now = new Date();
        const day = LuxConsoleService_1.checkTime(now.getDate());
        const month = LuxConsoleService_1.checkTime(now.getMonth() + 1);
        const year = LuxConsoleService_1.checkTime(now.getFullYear());
        const hours = LuxConsoleService_1.checkTime(now.getHours());
        const minutes = LuxConsoleService_1.checkTime(now.getMinutes());
        const seconds = LuxConsoleService_1.checkTime(now.getSeconds());
        return day + '.' + month + '.' + year + ' ' + hours + ':' + minutes + ':' + seconds;
    }
    static getLogValue(...args) {
        const logValue = [];
        args.forEach(arg => {
            if (arg !== null && typeof arg === 'object') {
                arg = JSON.stringify(arg);
            }
            logValue.push(arg);
        });
        return logValue;
    }
    static isDebugMode() {
        return LuxConsoleService_1.config ? LuxConsoleService_1.config.displayLuxConsoleLogs : environment.production;
    }
    static checkTime(timeUnit) {
        return timeUnit < 10 ? '0' + timeUnit : timeUnit;
    }
};
LuxConsoleService.config = {};
LuxConsoleService.ctorParameters = () => [
    { type: LuxComponentsConfigService }
];
LuxConsoleService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function LuxConsoleService_Factory() { return new LuxConsoleService(i0.ɵɵinject(i1.LuxComponentsConfigService)); }, token: LuxConsoleService, providedIn: "root" });
LuxConsoleService = LuxConsoleService_1 = tslib_1.__decorate([
    Injectable({
        providedIn: 'root'
    }),
    tslib_1.__metadata("design:paramtypes", [LuxComponentsConfigService])
], LuxConsoleService);
export { LuxConsoleService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LWNvbnNvbGUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BpaGstZ2ZpL2x1eC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9tb2R1bGVzL2x1eC11dGlsL2x1eC1jb25zb2xlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUNoRSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSx3REFBd0QsQ0FBQzs7O0FBR3BHLE1BQU0sQ0FBQyxNQUFNLElBQUksR0FBRyxHQUFRLEVBQUUsQ0FBQyxTQUFTLENBQUM7QUFLekMsSUFBYSxpQkFBaUIseUJBQTlCLE1BQWEsaUJBQWlCO0lBRzVCLFlBQVksdUJBQW1EO1FBQzdELDJFQUEyRTtRQUMzRSx1QkFBdUIsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsU0FBd0MsRUFBRSxFQUFFO1lBQ3BGLG1CQUFpQixDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsMkVBQTJFO0lBRTNFLElBQUksR0FBRztRQUNMLElBQUksbUJBQWlCLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDbkMsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsbUJBQWlCLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7U0FDeEY7YUFBTTtZQUNMLE9BQU8sSUFBSSxDQUFDO1NBQ2I7SUFDSCxDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ04sSUFBSSxtQkFBaUIsQ0FBQyxXQUFXLEVBQUUsRUFBRTtZQUNuQyxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFP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QixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsbUJBQWlCLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDO0lBQzVHLENBQUM7SUFFTyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQWdCO1FBQ3ZDLE9BQU8sUUFBUSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0lBQ25ELENBQUM7Q0FDRixDQUFBO0FBcklRLHdCQUFNLEdBQWtDLEVBQUUsQ0FBQzs7WUFFYiwwQkFBMEI7OztBQUhwRCxpQkFBaUI7SUFIN0IsVUFBVSxDQUFDO1FBQ1YsVUFBVSxFQUFFLE1BQU07S0FDbkIsQ0FBQzs2Q0FJcUMsMEJBQTBCO0dBSHBELGlCQUFpQixDQXNJN0I7U0F0SVksaUJBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgTHV4Q29tcG9uZW50c0NvbmZpZ1NlcnZpY2UgfSBmcm9tICcuLi9sdXgtY29tcG9uZW50cy1jb25maWcvbHV4LWNvbXBvbmVudHMtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHsgTHV4Q29tcG9uZW50c0NvbmZpZ1BhcmFtZXRlcnMgfSBmcm9tICcuLi9sdXgtY29tcG9uZW50cy1jb25maWcvbHV4LWNvbXBvbmVudHMtY29uZmlnLXBhcmFtZXRlcnMuaW50ZXJmYWNlJztcblxuZXhwb3J0IGNvbnN0IG5vb3AgPSAoKTogYW55ID0+IHVuZGVmaW5lZDtcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgTHV4Q29uc29sZVNlcnZpY2Uge1xuICBzdGF0aWMgY29uZmlnOiBMdXhDb21wb25lbnRzQ29uZmlnUGFyYW1ldGVycyA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yKGNvbXBvbmVudHNDb25maWdTZXJ2aWNlOiBMdXhDb21wb25lbnRzQ29uZmlnU2VydmljZSkge1xuICAgIC8vIEF1cyBkZXIgS29uZmlndXJhdGlvbiBkaWUgSW5mbyBlcmhhbHRlbiwgb2IgTG9ncyBhbmdlemVpZ3Qgd2VyZGVuIHNvbGxlblxuICAgIGNvbXBvbmVudHNDb25maWdTZXJ2aWNlLmNvbmZpZy5zdWJzY3JpYmUoKG5ld0NvbmZpZzogTHV4Q29tcG9uZW50c0NvbmZpZ1BhcmFtZXRlcnMpID0+IHtcbiAgICAgIEx1eENvbnNvbGVTZXJ2aWNlLmNvbmZpZyA9IG5ld0NvbmZpZztcbiAgICB9KTtcbiAgfVxuXG4gIC8qIE5pY2h0LXN0YXRpc2NoZSBMb2ctTWV0aG9kZW4sIHNpZSB6ZWlnZW4gYXVjaCBkaWUgUXVlbGxlIGRlcyBMb2dzIGFuISAqL1xuXG4gIGdldCBsb2coKSB7XG4gICAgaWYgKEx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLmxvZy5iaW5kLmNhbGwoY29uc29sZS5sb2csIGNvbnNvbGUsIEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gIH1cblxuICBnZXQgd2FybigpIHtcbiAgICBpZiAoTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUud2Fybi5iaW5kLmNhbGwoY29uc29sZS53YXJuLCBjb25zb2xlLCBMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVycm9yKCkge1xuICAgIGlmIChMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm4gY29uc29sZS5lcnJvci5iaW5kLmNhbGwoY29uc29sZS5lcnJvciwgY29uc29sZSwgTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgfVxuXG4gIGdldCBncm91cCgpIHtcbiAgICBpZiAoTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUuZ3JvdXAuYmluZC5jYWxsKGNvbnNvbGUuZ3JvdXAsIGNvbnNvbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gIH1cblxuICBnZXQgaW5mbygpIHtcbiAgICBpZiAoTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUuaW5mby5iaW5kLmNhbGwoY29uc29sZS5pbmZvLCBjb25zb2xlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGdyb3VwRW5kKCkge1xuICAgIGlmIChMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm4gY29uc29sZS5ncm91cEVuZC5iaW5kLmNhbGwoY29uc29sZS5ncm91cEVuZCwgY29uc29sZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgfVxuXG4gIC8qIFN0YXRpc2NoZSBMb2ctTWV0aG9kZW4sIHNpZSB6ZWlnZW4gbmljaHQgZGllIFF1ZWxsZSBkZXMgTG9ncyBhbiEgKi9cblxuICBzdGF0aWMgTE9HKC4uLmFyZ3MpIHtcbiAgICBpZiAoIUx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIGFyZ3NbMF0gIT09IG51bGwgJiYgdHlwZW9mIGFyZ3NbMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICBjb25zb2xlLmxvZyhMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nLCBhcmdzWzBdKTtcbiAgICB9IGVsc2UgaWYgKGFyZ3MubGVuZ3RoID09PSAxKSB7XG4gICAgICBjb25zb2xlLmxvZyhMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nLCBhcmdzWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtICcgKyB0aGlzLmdldExvZ1ZhbHVlKGFyZ3MpKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgV0FSTiguLi5hcmdzKSB7XG4gICAgaWYgKCFMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMSAmJiBhcmdzWzBdICE9PSBudWxsICYmIHR5cGVvZiBhcmdzWzBdID09PSAnb2JqZWN0Jykge1xuICAgICAgY29uc29sZS53YXJuKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScsIGFyZ3NbMF0pO1xuICAgIH0gZWxzZSBpZiAoYXJncy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnNvbGUud2FybihMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nLCBhcmdzWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLSAnICsgdGhpcy5nZXRMb2dWYWx1ZShhcmdzKSk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIEVSUk9SKC4uLmFyZ3MpIHtcbiAgICBpZiAoIUx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIGFyZ3NbMF0gIT09IG51bGwgJiYgdHlwZW9mIGFyZ3NbMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICBjb25zb2xlLmVycm9yKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScsIGFyZ3NbMF0pO1xuICAgIH0gZWxzZSBpZiAoYXJncy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtJywgYXJnc1swXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtICcgKyB0aGlzLmdldExvZ1ZhbHVlKGFyZ3MpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBsb2dEYXRlKCkge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICBjb25zdCBkYXkgPSBMdXhDb25zb2xlU2VydmljZS5jaGVja1RpbWUobm93LmdldERhdGUoKSk7XG4gICAgY29uc3QgbW9udGggPSBMdXhDb25zb2xlU2VydmljZS5jaGVja1RpbWUobm93LmdldE1vbnRoKCkgKyAxKTtcbiAgICBjb25zdCB5ZWFyID0gTHV4Q29uc29sZVNlcnZpY2UuY2hlY2tUaW1lKG5vdy5nZXRGdWxsWWVhcigpKTtcbiAgICBjb25zdCBob3VycyA9IEx1eENvbnNvbGVTZXJ2aWNlLmNoZWNrVGltZShub3cuZ2V0SG91cnMoKSk7XG4gICAgY29uc3QgbWludXRlcyA9IEx1eENvbnNvbGVTZXJ2aWNlLmNoZWNrVGltZShub3cuZ2V0TWludXRlcygpKTtcbiAgICBjb25zdCBzZWNvbmRzID0gTHV4Q29uc29sZVNlcnZpY2UuY2hlY2tUaW1lKG5vdy5nZXRTZWNvbmRzKCkpO1xuXG4gICAgcmV0dXJuIGRheSArICcuJyArIG1vbnRoICsgJy4nICsgeWVhciArICcgJyArIGhvdXJzICsgJzonICsgbWludXRlcyArICc6JyArIHNlY29uZHM7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZXRMb2dWYWx1ZSguLi5hcmdzKSB7XG4gICAgY29uc3QgbG9nVmFsdWUgPSBbXTtcblxuICAgIGFyZ3MuZm9yRWFjaChhcmcgPT4ge1xuICAgICAgaWYgKGFyZyAhPT0gbnVsbCAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0Jykge1xuICAgICAgICBhcmcgPSBKU09OLnN0cmluZ2lmeShhcmcpO1xuICAgICAgfVxuICAgICAgbG9nVmFsdWUucHVzaChhcmcpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGxvZ1ZhbHVlO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNEZWJ1Z01vZGUoKSB7XG4gICAgcmV0dXJuIEx1eENvbnNvbGVTZXJ2aWNlLmNvbmZpZyA/IEx1eENvbnNvbGVTZXJ2aWNlLmNvbmZpZy5kaXNwbGF5THV4Q29uc29sZUxvZ3MgOiBlbnZpcm9ubWVudC5wcm9kdWN0aW9uO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY2hlY2tUaW1lKHRpbWVVbml0OiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGltZVVuaXQgPCAxMCA/ICcwJyArIHRpbWVVbml0IDogdGltZVVuaXQ7XG4gIH1cbn1cbiJdfQ==
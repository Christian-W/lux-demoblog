import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { LuxMediaQueryObserverService } from '../../lux-util/lux-media-query-observer.service';
let LuxMasterDetailMobileHelperService = class LuxMasterDetailMobileHelperService {
    constructor(mediaObserver) {
        this.mediaObserver = mediaObserver;
        this._mdRegistered$ = new BehaviorSubject(false);
        this._masterCollapsed$ = new BehaviorSubject(true);
        this._hasValue$ = new BehaviorSubject(false);
        this.mediaObserver.getMediaQueryChangedAsObservable().subscribe(() => {
            setTimeout(() => {
                this.handleMasterCollapseState();
            });
        });
    }
    get masterCollapsed$() {
        return this._masterCollapsed$.getValue();
    }
    get masterCollapsedObservable() {
        return this._masterCollapsed$.asObservable();
    }
    get isRegisteredObservable() {
        return this._mdRegistered$.asObservable();
    }
    get isRegistered() {
        return this._mdRegistered$.getValue();
    }
    get hasValueObservable() {
        return this._hasValue$.asObservable();
    }
    get hasValue() {
        return this._hasValue$.getValue();
    }
    set hasValue(hasValue) {
        this._hasValue$.next(hasValue);
    }
    /**
     * Sendet ueber den masterCollapsed$-Subject ein Event mit dem Wert true.
     * Kennzeichnet das der Master geoeffnet werden soll.
     */
    openMaster() {
        this._masterCollapsed$.next(true);
    }
    /**
     * Sendet ueber den masterCollapsed$-Subject ein Event mit dem Wert false.
     * Kennzeichnet das der Master geschlossen werden soll.
     */
    closeMaster() {
        this._masterCollapsed$.next(false);
    }
    /**
     * Gibt zurueck ob eine Media-Query fuer XS oder SM aktuell aktiv ist.
     * @returns boolean
     */
    isMobile() {
        return this.mediaObserver.isXS() || this.mediaObserver.isSM();
    }
    /**
     * Meldet eine Master-Detail-Komponente fuer diesen Service an.
     */
    register() {
        if (!this.isRegistered) {
            this._mdRegistered$.next(true);
        }
        else {
            console.error('Fehler: Ein Master-Detail-Helper-Service kann nur eine registrierte Master-Detail-Komponente haben.');
        }
    }
    /**
     * Meldet die aktuelle Master-Detail-Komponente dieses Services ab.
     */
    unregister() {
        if (this.isRegistered) {
            this._mdRegistered$.next(false);
        }
    }
    /**
     * Sendet ein Event um den Master zu oeffnen bzw. zu schliessen
     * wenn sich der Zustand der Media-Query geaendert hat.
     */
    handleMasterCollapseState() {
        setTimeout(() => {
            if (this.hasValue && (this.mediaObserver.isXS() || this.mediaObserver.isSM())) {
                this.closeMaster();
            }
            else {
                this.openMaster();
            }
        });
    }
};
LuxMasterDetailMobileHelperService.ctorParameters = () => [
    { type: LuxMediaQueryObserverService }
];
LuxMasterDetailMobileHelperService = tslib_1.__decorate([
    Injectable(),
    tslib_1.__metadata("design:paramtypes", [LuxMediaQueryObserverService])
], LuxMasterDetailMobileHelperService);
export { LuxMasterDetailMobileHelperService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LW1hc3Rlci1kZXRhaWwtbW9iaWxlLWhlbHBlci5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGloay1nZmkvbHV4LWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJzcmMvYXBwL21vZHVsZXMvbHV4LWxheW91dC9sdXgtbWFzdGVyLWRldGFpbC9sdXgtbWFzdGVyLWRldGFpbC1tb2JpbGUtaGVscGVyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUNuRCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQUcvRixJQUFhLGtDQUFrQyxHQUEvQyxNQUFhLGtDQUFrQztJQUs3QyxZQUFvQixhQUEyQztRQUEzQyxrQkFBYSxHQUFiLGFBQWEsQ0FBOEI7UUFKdkQsbUJBQWMsR0FBNkIsSUFBSSxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEUsc0JBQWlCLEdBQTZCLElBQUksZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hFLGVBQVUsR0FBNkIsSUFBSSxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7UUFHeEUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxnQ0FBZ0MsRUFBRSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUU7WUFDbkUsVUFBVSxDQUFDLEdBQUcsRUFBRTtnQkFDZCxJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztZQUNuQyxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELElBQVcsZ0JBQWdCO1FBQ3pCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzNDLENBQUM7SUFFRCxJQUFXLHlCQUF5QjtRQUNsQyxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQsSUFBVyxzQkFBc0I7UUFDL0IsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQzVDLENBQUM7SUFFRCxJQUFXLFlBQVk7UUFDckIsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3hDLENBQUM7SUFFRCxJQUFXLGtCQUFrQjtRQUMzQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDeEMsQ0FBQztJQUVELElBQVcsUUFBUTtRQUNqQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDcEMsQ0FBQztJQUVELElBQVcsUUFBUSxDQUFDLFFBQWlCO1FBQ25DLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxVQUFVO1FBQ2YsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksV0FBVztRQUNoQixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxRQUFRO1FBQ2IsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDaEUsQ0FBQztJQUVEOztPQUVHO0lBQ0ksUUFBUTtRQUNiLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ3RCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2hDO2FBQU07WUFDTCxPQUFPLENBQUMsS0FBSyxDQUNYLHFHQUFxRyxDQUN0RyxDQUFDO1NBQ0g7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxVQUFVO1FBQ2YsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ2pDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNLLHlCQUF5QjtRQUMvQixVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUU7Z0JBQzdFLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQzthQUNwQjtpQkFBTTtnQkFDTCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7YUFDbkI7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRixDQUFBOztZQS9Gb0MsNEJBQTRCOztBQUxwRCxrQ0FBa0M7SUFEOUMsVUFBVSxFQUFFOzZDQU13Qiw0QkFBNEI7R0FMcEQsa0NBQWtDLENBb0c5QztTQXBHWSxrQ0FBa0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEx1eE1lZGlhUXVlcnlPYnNlcnZlclNlcnZpY2UgfSBmcm9tICcuLi8uLi9sdXgtdXRpbC9sdXgtbWVkaWEtcXVlcnktb2JzZXJ2ZXIuc2VydmljZSc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBMdXhNYXN0ZXJEZXRhaWxNb2JpbGVIZWxwZXJTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBfbWRSZWdpc3RlcmVkJDogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG4gIHByaXZhdGUgX21hc3RlckNvbGxhcHNlZCQ6IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPiA9IG5ldyBCZWhhdmlvclN1YmplY3QodHJ1ZSk7XG4gIHByaXZhdGUgX2hhc1ZhbHVlJDogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtZWRpYU9ic2VydmVyOiBMdXhNZWRpYVF1ZXJ5T2JzZXJ2ZXJTZXJ2aWNlKSB7XG4gICAgdGhpcy5tZWRpYU9ic2VydmVyLmdldE1lZGlhUXVlcnlDaGFuZ2VkQXNPYnNlcnZhYmxlKCkuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmhhbmRsZU1hc3RlckNvbGxhcHNlU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIGdldCBtYXN0ZXJDb2xsYXBzZWQkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9tYXN0ZXJDb2xsYXBzZWQkLmdldFZhbHVlKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0IG1hc3RlckNvbGxhcHNlZE9ic2VydmFibGUoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuX21hc3RlckNvbGxhcHNlZCQuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGlzUmVnaXN0ZXJlZE9ic2VydmFibGUoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuX21kUmVnaXN0ZXJlZCQuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGlzUmVnaXN0ZXJlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fbWRSZWdpc3RlcmVkJC5nZXRWYWx1ZSgpO1xuICB9XG5cbiAgcHVibGljIGdldCBoYXNWYWx1ZU9ic2VydmFibGUoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuX2hhc1ZhbHVlJC5hc09ic2VydmFibGUoKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgaGFzVmFsdWUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2hhc1ZhbHVlJC5nZXRWYWx1ZSgpO1xuICB9XG5cbiAgcHVibGljIHNldCBoYXNWYWx1ZShoYXNWYWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2hhc1ZhbHVlJC5uZXh0KGhhc1ZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kZXQgdWViZXIgZGVuIG1hc3RlckNvbGxhcHNlZCQtU3ViamVjdCBlaW4gRXZlbnQgbWl0IGRlbSBXZXJ0IHRydWUuXG4gICAqIEtlbm56ZWljaG5ldCBkYXMgZGVyIE1hc3RlciBnZW9lZmZuZXQgd2VyZGVuIHNvbGwuXG4gICAqL1xuICBwdWJsaWMgb3Blbk1hc3RlcigpOiB2b2lkIHtcbiAgICB0aGlzLl9tYXN0ZXJDb2xsYXBzZWQkLm5leHQodHJ1ZSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZGV0IHVlYmVyIGRlbiBtYXN0ZXJDb2xsYXBzZWQkLVN1YmplY3QgZWluIEV2ZW50IG1pdCBkZW0gV2VydCBmYWxzZS5cbiAgICogS2VubnplaWNobmV0IGRhcyBkZXIgTWFzdGVyIGdlc2NobG9zc2VuIHdlcmRlbiBzb2xsLlxuICAgKi9cbiAgcHVibGljIGNsb3NlTWFzdGVyKCk6IHZvaWQge1xuICAgIHRoaXMuX21hc3RlckNvbGxhcHNlZCQubmV4dChmYWxzZSk7XG4gIH1cblxuICAvKipcbiAgICogR2lidCB6dXJ1ZWNrIG9iIGVpbmUgTWVkaWEtUXVlcnkgZnVlciBYUyBvZGVyIFNNIGFrdHVlbGwgYWt0aXYgaXN0LlxuICAgKiBAcmV0dXJucyBib29sZWFuXG4gICAqL1xuICBwdWJsaWMgaXNNb2JpbGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubWVkaWFPYnNlcnZlci5pc1hTKCkgfHwgdGhpcy5tZWRpYU9ic2VydmVyLmlzU00oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZWxkZXQgZWluZSBNYXN0ZXItRGV0YWlsLUtvbXBvbmVudGUgZnVlciBkaWVzZW4gU2VydmljZSBhbi5cbiAgICovXG4gIHB1YmxpYyByZWdpc3RlcigpIHtcbiAgICBpZiAoIXRoaXMuaXNSZWdpc3RlcmVkKSB7XG4gICAgICB0aGlzLl9tZFJlZ2lzdGVyZWQkLm5leHQodHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICdGZWhsZXI6IEVpbiBNYXN0ZXItRGV0YWlsLUhlbHBlci1TZXJ2aWNlIGthbm4gbnVyIGVpbmUgcmVnaXN0cmllcnRlIE1hc3Rlci1EZXRhaWwtS29tcG9uZW50ZSBoYWJlbi4nXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWxkZXQgZGllIGFrdHVlbGxlIE1hc3Rlci1EZXRhaWwtS29tcG9uZW50ZSBkaWVzZXMgU2VydmljZXMgYWIuXG4gICAqL1xuICBwdWJsaWMgdW5yZWdpc3RlcigpIHtcbiAgICBpZiAodGhpcy5pc1JlZ2lzdGVyZWQpIHtcbiAgICAgIHRoaXMuX21kUmVnaXN0ZXJlZCQubmV4dChmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRldCBlaW4gRXZlbnQgdW0gZGVuIE1hc3RlciB6dSBvZWZmbmVuIGJ6dy4genUgc2NobGllc3NlblxuICAgKiB3ZW5uIHNpY2ggZGVyIFp1c3RhbmQgZGVyIE1lZGlhLVF1ZXJ5IGdlYWVuZGVydCBoYXQuXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZU1hc3RlckNvbGxhcHNlU3RhdGUoKTogdm9pZCB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy5oYXNWYWx1ZSAmJiAodGhpcy5tZWRpYU9ic2VydmVyLmlzWFMoKSB8fCB0aGlzLm1lZGlhT2JzZXJ2ZXIuaXNTTSgpKSkge1xuICAgICAgICB0aGlzLmNsb3NlTWFzdGVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9wZW5NYXN0ZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIl19
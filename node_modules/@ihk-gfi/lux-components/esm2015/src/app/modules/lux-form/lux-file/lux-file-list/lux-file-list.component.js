import * as tslib_1 from "tslib";
import { AfterViewChecked, AfterViewInit, ChangeDetectorRef, Component, ElementRef, Input, OnDestroy, Optional, QueryList, ViewChild, ViewChildren } from '@angular/core';
import { ControlContainer } from '@angular/forms';
import { LuxConsoleService } from '../../../lux-util/lux-console.service';
import { LuxFormFileBase } from '../../lux-form-model/lux-form-file-base.class';
import { HttpClient } from '@angular/common/http';
import { LuxFileErrorCause } from '../lux-file-model/lux-file-error.interface';
import { LuxComponentsConfigService } from '../../../lux-components-config/lux-components-config.service';
import { LiveAnnouncer } from '@angular/cdk/a11y';
import { LuxCardComponent } from '../../../lux-layout/lux-card/lux-card.component';
let LuxFileListComponent = class LuxFileListComponent extends LuxFormFileBase {
    constructor(controlContainer, cdr, logger, http, liveAnnouncer, config) {
        super(controlContainer, cdr, logger, config, http, liveAnnouncer);
        this._luxUploadActionConfig = {
            disabled: false,
            disabledHeader: false,
            hidden: false,
            hiddenHeader: false,
            iconName: 'fas fa-cloud-upload-alt',
            iconNameHeader: 'fas fa-cloud-upload-alt',
            label: 'Hochladen',
            labelHeader: 'Neue Dateien hochladen'
        };
        this._luxDeleteActionConfig = {
            disabled: false,
            disabledHeader: false,
            hidden: false,
            hiddenHeader: false,
            iconName: 'fas fa-trash',
            iconNameHeader: 'fas fa-trash',
            label: 'Löschen',
            labelHeader: 'Alle Dateien entfernen'
        };
        this.fileIcons = [];
        this.rowWidth = 0;
        this.iconActionBarWidth = 50;
        this.alwaysVisibleView = false;
        this.alwaysVisibleUpload = false;
        this.alwaysVisibleDownload = false;
        this.alwaysVisibleDelete = false;
        this.luxShowPreview = true;
        this.luxMultiple = true;
        this.luxBackgroundIconName = 'fas fa-cloud-upload-alt';
    }
    get luxUploadActionConfig() {
        return this._luxUploadActionConfig;
    }
    set luxUploadActionConfig(config) {
        if (config) {
            this._luxUploadActionConfig = config;
        }
    }
    get luxDeleteActionConfig() {
        return this._luxDeleteActionConfig;
    }
    set luxDeleteActionConfig(config) {
        if (config) {
            this._luxDeleteActionConfig = config;
        }
    }
    ngAfterViewInit() {
        this._fileEntryNodesChangeSubscr = this.fileEntries.changes.subscribe(() => {
            this.updateIconAndImage();
        });
        this.updateIconAndImage();
    }
    updateIconAndImage() {
        this.setFileIcons();
        if (this.luxShowPreview) {
            this.setImgSrcs();
        }
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        if (this._fileEntryNodesChangeSubscr) {
            this._fileEntryNodesChangeSubscr.unsubscribe();
        }
    }
    shouldDisplayPreviewImg(index) {
        return (this.luxShowPreview && this.fileIcons && this.fileIcons[index] && this.fileIcons[index] === 'fas fa-file-image');
    }
    /**
     * Entfernt eine Datei aus den selektierten Dateien.
     * @param index
     */
    removeFile(index) {
        this.formControl.markAsTouched();
        this.formControl.markAsDirty();
        // Wenn mehrere Dateien selektiert sind, diese nach der entfernten Datei filtern ansonsten "undefined" nutzen
        const newFiles = Array.isArray(this.luxSelectedFiles)
            ? this.luxSelectedFiles.filter((file, searchIndex) => searchIndex !== index)
            : undefined;
        // Via LiveAnnouncer mitteilen welche Datei entfernt wird
        this.announceFileRemove(Array.isArray(this.luxSelectedFiles) ? this.luxSelectedFiles[index].name : this.luxSelectedFiles.name);
        // Wir entfernen hier nur eine Datei, deshalb ist das neue Auslesen der Base64-Strings nicht nötig
        this.uploadFiles(newFiles).then(() => {
            this.luxSelectedFiles = newFiles && newFiles.length === 1 ? newFiles[0] : newFiles;
            this.notifyFormValueChanged();
        }, error => this.setFormControlErrors(error));
        if (this.luxDeleteActionConfig.onClick) {
            this.luxDeleteActionConfig.onClick();
        }
    }
    /**
     * Fügt weitere Dateien zu den bereits vorhandenen hinzu bzw. ersetzt diese.
     * @param files
     */
    selectFiles(files) {
        this.formControl.markAsTouched();
        this.formControl.markAsDirty();
        this.forceProgressIndeterminate = true;
        this.announceFileProcess(files && files.length > 1);
        if (!files || files.length === 0) {
            this.forceProgressIndeterminate = false;
            return;
        }
        // Timeout, um Flackern durch Progress zu vermeiden
        setTimeout(() => {
            // Prüfen ob die Dateien bereits vorhanden sind
            let selectedFilesArray = [];
            const replaceableFilesMap = new Map();
            if (this.luxSelectedFiles) {
                files = Array.from(files);
                selectedFilesArray = Array.isArray(this.luxSelectedFiles) ? this.luxSelectedFiles : [this.luxSelectedFiles];
                // zu ersetzende Indizes herausfinden
                files.forEach((file) => {
                    const index = selectedFilesArray.findIndex((compareFile) => compareFile.name === file.name);
                    if (index > -1) {
                        replaceableFilesMap.set(index, file);
                    }
                });
            }
            // Wenn mehrere Dateien selektiert sind und luxMultiple dies unterbindet, Fehler werfen und Fn beenden
            // Ausnahme ist, wenn die Dateien nur ersetzt werden sollen
            if (!this.luxMultiple &&
                ((!this.luxSelectedFiles && files.length > 1) ||
                    (this.luxSelectedFiles && this.luxSelectedFiles.length > 1) ||
                    (this.luxSelectedFiles && replaceableFilesMap.size !== files.length))) {
                this.setFormControlErrors({
                    cause: LuxFileErrorCause.MultipleForbidden,
                    exception: this.getMultipleForbiddenMessage(),
                    file: null
                });
                return;
            }
            this.updateSelectedFiles(files).then((newFiles) => {
                const tempSelectedFiles = selectedFilesArray;
                // die zu ersetzenden Dateien durchgehen und aktualisieren
                replaceableFilesMap.forEach((file, index) => {
                    const replaceableFileObject = newFiles.find((newFile) => newFile.name === file.name);
                    // das gefundene Objekt aus den newFiles entfernen
                    newFiles = newFiles.filter(newFile => newFile !== replaceableFileObject);
                    // die selectedFiles aktualisieren
                    tempSelectedFiles[index] = replaceableFileObject;
                });
                // die übrigen neuen Dateien anfügen
                tempSelectedFiles.push(...newFiles);
                this.luxSelectedFiles =
                    tempSelectedFiles && tempSelectedFiles.length === 1 ? tempSelectedFiles[0] : tempSelectedFiles;
                this.notifyFormValueChanged();
            }, error => this.setFormControlErrors(error));
        }, this.defaultReadFileDelay);
    }
    /**
     * Aktualisiert die Preview-Bilder für die (Image-)Dateien.
     *
     * Aktualisierung absichtlich via Funktion und nicht Property-Binding, da potentiell Stack-Size Fehler auftreten,
     * wenn (große) Base64-Strings gegen die src gebunden werden.
     */
    setImgSrcs() {
        this.fileEntries.forEach((item, index) => {
            const imgElement = item.nativeElement.querySelector('img');
            if (imgElement && this.luxSelectedFiles) {
                const targetFileContent = Array.isArray(this.luxSelectedFiles)
                    ? this.luxSelectedFiles[index].content
                    : this.luxSelectedFiles.content;
                if (targetFileContent instanceof Blob) {
                    this.readFile(targetFileContent).then((content) => {
                        imgElement.src = content;
                    });
                }
                else {
                    imgElement.src = targetFileContent;
                }
            }
        });
    }
    /**
     * Setzt die Icons für die Elemente in der Auflistung
     */
    setFileIcons() {
        if (!this.luxSelectedFiles) {
            return;
        }
        this.fileIcons = [];
        const selectedFiles = [];
        if (!Array.isArray(this.luxSelectedFiles)) {
            selectedFiles.push(this.luxSelectedFiles);
        }
        else {
            selectedFiles.push(...this.luxSelectedFiles);
        }
        selectedFiles.forEach((selectedFile) => {
            let newFileIcon = 'fas fa-file';
            if (selectedFile.type) {
                if (selectedFile.type.indexOf('image') > -1) {
                    newFileIcon = 'fas fa-file-image';
                }
                else if (selectedFile.type.indexOf('pdf') > -1) {
                    newFileIcon = 'fas fa-file-pdf';
                }
                else if (selectedFile.type.indexOf('spreadsheet') > -1) {
                    newFileIcon = 'fas fa-file-excel';
                }
                else if (selectedFile.type.indexOf('officedocument') > -1) {
                    newFileIcon = 'fas fa-file-signature';
                }
                else if (selectedFile.type.indexOf('json') > -1) {
                    newFileIcon = 'fas fa-file-code';
                }
            }
            this.fileIcons.push(newFileIcon);
        });
        this.cdr.detectChanges();
    }
    ngAfterViewChecked() {
        this.resizeIconActionBar();
    }
    isArray(object) {
        return object && Array.isArray(object);
    }
    resizeIconActionBar() {
        if (this.fileEntries && this.fileEntries.first && this.cdr) {
            const newRowWidth = this.fileEntries.first.nativeElement.offsetWidth;
            if (this.rowWidth !== newRowWidth) {
                this.rowWidth = newRowWidth;
                if (this.rowWidth >= 500) {
                    this.iconActionBarWidth = 200;
                    this.alwaysVisibleView = true;
                    this.alwaysVisibleUpload = true;
                    this.alwaysVisibleDownload = true;
                    this.alwaysVisibleDelete = true;
                }
                else if (this.rowWidth >= 400) {
                    this.iconActionBarWidth = 150;
                    this.alwaysVisibleView = false;
                    this.alwaysVisibleUpload = false;
                    this.alwaysVisibleDownload = true;
                    this.alwaysVisibleDelete = true;
                }
                else {
                    this.iconActionBarWidth = 50;
                    this.alwaysVisibleView = false;
                    this.alwaysVisibleUpload = false;
                    this.alwaysVisibleDownload = false;
                    this.alwaysVisibleDelete = false;
                }
                this.cdr.detectChanges();
            }
        }
    }
    // region Overridden methods
    errorMessageModifier(value, errors) {
        if (errors.required) {
            return 'Es muss mindestens eine Datei ausgewählt werden';
        }
        return super.errorMessageModifier(value, errors);
    }
    triggerViewFileClick(file) {
        super.triggerViewFileClick(file);
        this.updateIconAndImage();
    }
    notifyFormValueChanged() {
        super.notifyFormValueChanged();
        this.formControl.updateValueAndValidity();
        this.fileuploadSingleInput.nativeElement.value = null;
    }
};
LuxFileListComponent.ctorParameters = () => [
    { type: ControlContainer, decorators: [{ type: Optional }] },
    { type: ChangeDetectorRef },
    { type: LuxConsoleService },
    { type: HttpClient },
    { type: LiveAnnouncer },
    { type: LuxComponentsConfigService }
];
tslib_1.__decorate([
    ViewChildren('fileEntry', { read: ElementRef }),
    tslib_1.__metadata("design:type", QueryList)
], LuxFileListComponent.prototype, "fileEntries", void 0);
tslib_1.__decorate([
    ViewChild('fileuploadSingle', { read: ElementRef, static: true }),
    tslib_1.__metadata("design:type", ElementRef)
], LuxFileListComponent.prototype, "fileuploadSingleInput", void 0);
tslib_1.__decorate([
    ViewChild(LuxCardComponent, { read: ElementRef, static: true }),
    tslib_1.__metadata("design:type", ElementRef)
], LuxFileListComponent.prototype, "fileCard", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Boolean)
], LuxFileListComponent.prototype, "luxShowPreview", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Boolean)
], LuxFileListComponent.prototype, "luxMultiple", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", String)
], LuxFileListComponent.prototype, "luxBackgroundIconName", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object),
    tslib_1.__metadata("design:paramtypes", [Object])
], LuxFileListComponent.prototype, "luxUploadActionConfig", null);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object),
    tslib_1.__metadata("design:paramtypes", [Object])
], LuxFileListComponent.prototype, "luxDeleteActionConfig", null);
LuxFileListComponent = tslib_1.__decorate([
    Component({
        selector: 'lux-file-list',
        template: "<lux-card\n  class=\"lux-file-list\"\n  [ngClass]=\"{ 'lux-file-list-disabled': luxDisabled }\"\n  [luxTitle]=\"(luxLabel ? luxLabel : '') + (luxRequired ? ' *' : '')\"\n  [luxAriaInvalid]=\"formControl?.invalid\"\n  tabindex=\"0\"\n>\n  <lux-card-info *ngIf=\"luxMultiple || !luxSelectedFiles\">\n    <lux-button\n      class=\"lux-file-list-header-clear\"\n      [luxIconName]=\"luxDeleteActionConfig.iconNameHeader\"\n      luxTagId=\"lux-file-clear\"\n      luxColor=\"primary\"\n      [luxDisabled]=\"\n        !luxSelectedFiles ||\n        luxSelectedFiles.length === 0 ||\n        luxDeleteActionConfig.disabledHeader ||\n        luxDisabled ||\n        luxReadonly\n      \"\n      (luxClicked)=\"clearFiles($event)\"\n      fxFlex=\"0 0 auto\"\n      [luxAriaLabel]=\"luxDeleteActionConfig.labelHeader\"\n      luxAriaLabelSelector=\"button\"\n      *ngIf=\"!luxDeleteActionConfig.hiddenHeader\"\n    >\n    </lux-button>\n    <lux-button\n      class=\"lux-file-list-header-add\"\n      [luxIconName]=\"luxUploadActionConfig.iconNameHeader\"\n      luxTagId=\"lux-file-add\"\n      (luxClicked)=\"fileupload.click()\"\n      fxFlex=\"0 0 auto\"\n      [luxDisabled]=\"luxUploadActionConfig.disabledHeader || luxDisabled || luxReadonly\"\n      luxColor=\"primary\"\n      [luxAriaLabel]=\"luxUploadActionConfig.labelHeader\"\n      luxAriaLabelSelector=\"button\"\n      *ngIf=\"!luxUploadActionConfig.hiddenHeader\"\n    >\n    </lux-button>\n  </lux-card-info>\n  <lux-card-content>\n    <div\n      class=\"lux-file-list-content\"\n      fxFlex=\"1 0 75px\"\n      fxLayout=\"column\"\n      fxLayoutAlign=\"{{ !luxSelectedFiles || luxSelectedFiles.length === 0 ? 'center center' : 'start start' }}\"\n    >\n      <div\n        class=\"lux-file-icon-hint\"\n        fxFlexFill\n        fxLayout=\"column\"\n        fxLayoutAlign=\"center center\"\n        *ngIf=\"!luxSelectedFiles || luxSelectedFiles.length === 0\"\n      >\n        <lux-divider></lux-divider>\n        <lux-icon\n          class=\"lux-file-icon\"\n          [luxIconSize]=\"'3x'\"\n          [luxIconName]=\"luxUploadActionConfig.iconName\"\n          [luxPadding]=\"'0'\"\n          [luxMargin]=\"'0'\"\n          *ngIf=\"luxUploadActionConfig.iconName\"\n        >\n        </lux-icon>\n        <mat-hint [id]=\"uid + '-misc'\" fxFlexOffset=\"8px\" *ngIf=\"formHintComponent || luxHint\">\n          <ng-container *ngIf=\"luxHint; else formHintTemplate\">\n            {{ luxHint }}\n          </ng-container>\n          <ng-template #formHintTemplate>\n            <ng-container *ngTemplateOutlet=\"formHintComponent.templateRef\"></ng-container>\n          </ng-template>\n        </mat-hint>\n      </div>\n      <div class=\"lux-file-list-entries\" fxFlexFill *ngIf=\"luxSelectedFiles\">\n        <!-- Mehrere Dateien ausgew\u00E4hlt -->\n        <ng-container *ngIf=\"isArray(luxSelectedFiles)\">\n          <lux-divider></lux-divider>\n          <ng-container *ngFor=\"let selectedFile of luxSelectedFiles; let i = index\">\n            <ng-container *ngTemplateOutlet=\"fileListEntryTemplate; context: { selectedFile: selectedFile, index: i }\">\n            </ng-container>\n          </ng-container>\n        </ng-container>\n        <!-- Nur eine Datei ausgew\u00E4hlt -->\n        <ng-container *ngIf=\"!isArray(luxSelectedFiles)\">\n          <lux-divider></lux-divider>\n          <ng-container\n            *ngTemplateOutlet=\"fileListEntryTemplate; context: { selectedFile: luxSelectedFiles, index: 0 }\"\n          >\n          </ng-container>\n        </ng-container>\n      </div>\n    </div>\n  </lux-card-content>\n  <lux-card-actions fxLayout=\"column\" fxFlexFill *ngIf=\"errorMessage && formControl?.touched\">\n    <mat-error [id]=\"uid + '-misc'\">\n      {{ errorMessage }}\n    </mat-error>\n  </lux-card-actions>\n</lux-card>\n<!-- Template f\u00FCr eine File-Entry -->\n<ng-template let-selectedFile=\"selectedFile\" let-index=\"index\" #fileListEntryTemplate>\n  <div\n    class=\"lux-file-list-entry lux-mt-2 lux-mb-2\"\n    fxLayout=\"row\"\n    fxLayoutAlign=\"start center\"\n    tabindex=\"0\"\n    [attr.aria-label]=\"'Datei ' + selectedFile.name\"\n    #fileEntry\n  >\n    <div fxLayout=\"row\" fxLayoutAlign=\"start center\" fxFlex=\"0 1 100%\">\n      <!-- Icon bzw. Img der Datei -->\n      <ng-container [ngSwitch]=\"shouldDisplayPreviewImg(index)\">\n        <ng-container *ngSwitchCase=\"false\">\n          <lux-icon\n            class=\"lux-file-list-entry-icon\"\n            luxPadding=\"0\"\n            luxMargin=\"0\"\n            [luxIconName]=\"fileIcons[index]\"\n            luxIconSize=\"2x\"\n            fxFlex=\"0 0 30px\"\n            aria-hidden\n          >\n          </lux-icon>\n        </ng-container>\n        <ng-container *ngSwitchCase=\"true\">\n          <img fxFlex=\"0 0 30px\" aria-hidden />\n        </ng-container>\n      </ng-container>\n      <!-- Der Name der Datei -->\n      <span class=\"lux-file-list-entry-label lux-mr-3\" fxFlex=\"0 1 auto\" fxFlexOffset=\"8px\">\n        {{ selectedFile.name }}\n      </span>\n    </div>\n    <div fxLayout=\"row\" fxLayoutAlign=\"start center\" [fxFlex]=\"'1 0 ' + iconActionBarWidth + 'px'\">\n      <!-- Buttons zum erneuten Hochladen bzw. L\u00F6schen der Datei -->\n      <lux-menu\n        luxMenuIconName=\"fas fa-ellipsis-v\"\n        luxTagId=\"{{ 'lux-file-list-entry-' + index + '-actions' }}\"\n        (luxMenuClosed)=\"fileEntry.focus()\"\n        [luxToggleDisabled]=\"luxDisabled || luxReadonly\"\n        [luxDisplayExtended]=\"true\"\n      >\n        <lux-menu-item\n          luxTagId=\"lux-file-list-entry-view\"\n          [luxIconName]=\"luxViewActionConfig.iconName\"\n          [luxDisabled]=\"luxViewActionConfig.disabled || luxDisabled || luxReadonly\"\n          [luxLabel]=\"luxViewActionConfig.label\"\n          [luxHideLabelIfExtended]=\"true\"\n          [luxAlwaysVisible]=\"alwaysVisibleView\"\n          luxColor=\"primary\"\n          (luxClicked)=\"viewFile(selectedFile)\"\n          [luxHidden]=\"!!luxViewActionConfig.hidden\"\n        >\n        </lux-menu-item>\n        <lux-menu-item\n          luxTagId=\"lux-file-list-entry-download\"\n          [luxIconName]=\"luxDownloadActionConfig.iconName\"\n          [luxDisabled]=\"luxDownloadActionConfig.disabled || luxDisabled || luxReadonly\"\n          [luxLabel]=\"luxDownloadActionConfig.label\"\n          [luxHideLabelIfExtended]=\"true\"\n          [luxAlwaysVisible]=\"alwaysVisibleDownload\"\n          luxColor=\"primary\"\n          (luxClicked)=\"downloadFile(selectedFile)\"\n          [luxHidden]=\"!!luxDownloadActionConfig.hidden\"\n        >\n        </lux-menu-item>\n        <lux-menu-item\n          luxTagId=\"lux-file-list-entry-remove\"\n          [luxIconName]=\"luxDeleteActionConfig.iconName\"\n          [luxDisabled]=\"luxDeleteActionConfig.disabled || luxDisabled || luxReadonly\"\n          [luxLabel]=\"luxDeleteActionConfig.label\"\n          [luxHideLabelIfExtended]=\"true\"\n          [luxAlwaysVisible]=\"alwaysVisibleDelete\"\n          luxColor=\"primary\"\n          (luxClicked)=\"removeFile(index)\"\n          [luxHidden]=\"!!luxDeleteActionConfig.hidden\"\n        >\n        </lux-menu-item>\n        <lux-menu-item\n          luxTagId=\"lux-file-list-entry-upload\"\n          [luxIconName]=\"luxUploadActionConfig.iconName\"\n          [luxDisabled]=\"luxUploadActionConfig.disabled || luxDisabled || luxReadonly\"\n          [luxLabel]=\"luxUploadActionConfig.label\"\n          [luxHideLabelIfExtended]=\"true\"\n          [luxAlwaysVisible]=\"alwaysVisibleUpload\"\n          luxColor=\"primary\"\n          (luxClicked)=\"fileuploadSingle.click()\"\n          [luxHidden]=\"!!luxUploadActionConfig.hidden\"\n        >\n        </lux-menu-item>\n      </lux-menu>\n    </div>\n  </div>\n  <ng-container *ngIf=\"luxSelectedFiles.length\">\n    <lux-divider *ngIf=\"index !== this.luxSelectedFiles.length - 1\"></lux-divider>\n  </ng-container>\n</ng-template>\n\n<!-- File-Upload Input -->\n<input\n  class=\"lux-file-input lux-file-input-multiple\"\n  type=\"file\"\n  [multiple]=\"luxMultiple\"\n  [accept]=\"luxAccept\"\n  [luxFileCapture]=\"luxCapture\"\n  (change)=\"selectFiles($event.target.files)\"\n  #fileupload\n/>\n<!-- File-Upload Single Input -->\n<input\n  class=\"lux-file-input lux-file-input-single\"\n  type=\"file\"\n  [multiple]=\"false\"\n  [accept]=\"luxAccept\"\n  [luxFileCapture]=\"luxCapture\"\n  (change)=\"selectFiles($event.target.files)\"\n  #fileuploadSingle\n/>\n\n<!-- Download-Node -->\n<a class=\"lux-file-download\" #downloadLink></a>\n\n<!-- Ladeanzeige f\u00FCr den File-Upload -->\n<lux-file-progress [luxMode]=\"progressMode\" [luxProgress]=\"progress\" *ngIf=\"isProgressVisible\"> </lux-file-progress>\n",
        styles: ["@charset \"UTF-8\";lux-side-nav .lux-side-nav-item,lux-side-nav lux-link{box-sizing:border-box}lux-side-nav .lux-side-nav-item.lux-side-nav-item-selected,lux-side-nav lux-link.lux-side-nav-item-selected{background-color:rgba(112,141,170,.2)!important;position:relative;border-radius:4px}lux-side-nav .lux-side-nav-item.lux-side-nav-item-selected:after,lux-side-nav lux-link.lux-side-nav-item-selected:after{content:'';left:0;width:6px;top:0;bottom:0;position:absolute;border-left:6px solid #0073b3;border-radius:4px 0 0 4px}lux-side-nav .lux-side-nav-item button .mat-button-focus-overlay,lux-side-nav lux-link button .mat-button-focus-overlay{display:none}lux-side-nav .lux-side-nav-item button:focus,lux-side-nav lux-link button:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}lux-side-nav .lux-side-nav-item button:hover,lux-side-nav lux-link button:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-list{border:4px solid transparent}lux-list:focus{outline-width:0;border:4px solid rgba(112,141,170,.2)!important}lux-list lux-list-item:focus{outline-width:0}lux-list lux-list-item:focus mat-card{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}lux-list lux-list-item lux-card.lux-list-item-selected mat-card{background-color:rgba(112,141,170,.2)!important;position:relative;border-radius:4px}lux-list lux-list-item lux-card.lux-list-item-selected mat-card:after{content:'';left:0;width:6px;top:0;bottom:0;position:absolute;border-left:6px solid #0073b3;border-radius:4px 0 0 4px}lux-list lux-list-item lux-card mat-card{box-sizing:border-box}lux-list lux-list-item lux-card mat-card:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .lux-form-control-label>*{color:#335c85}lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .cdk-focused .mat-radio-container,lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .mat-checkbox-inner-container,lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .mat-slide-toggle-thumb{position:relative}lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .cdk-focused .mat-radio-container:after,lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .mat-checkbox-inner-container:after,lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .mat-slide-toggle-thumb:after{content:\"\";border:1px solid rgba(112,141,170,.2);background-color:rgba(112,141,170,.2);display:block;top:-4px;left:-4px;right:-4px;bottom:-4px;border-radius:15px;z-index:1;position:absolute}lux-form-control .lux-form-control:not(.lux-form-control-disabled).lux-focused .lux-form-control-container:after{content:'';display:block;box-sizing:border-box;left:0;right:0;position:absolute;height:2px;border-bottom:2px solid #0073b3}lux-datepicker mat-datepicker-toggle button:focus:after{content:\"\";border:1px solid rgba(112,141,170,.2);background-color:rgba(112,141,170,.2);display:block;top:-4px;left:-4px;right:-4px;bottom:-4px;border-radius:15px;z-index:1;position:absolute}.lux-datepicker-panel .mat-calendar-header button .mat-button-focus-overlay,lux-datepicker mat-datepicker-toggle .mat-button-focus-overlay{display:none}.lux-datepicker-panel .mat-calendar-header button:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}.lux-datepicker-panel .mat-calendar-header button:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}.lux-datepicker-panel .mat-calendar-content td.mat-calendar-body-cell:hover>div{background-color:rgba(0,0,0,.2)!important;border-radius:999px}.lux-datepicker-panel .mat-calendar-content td.mat-calendar-body-cell.mat-calendar-body-active>div{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:999px}lux-table tr:hover>td,lux-table tr:hover>th{border-radius:0;background-color:#cfcfcf!important}lux-table th button.mat-sort-header-button:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}.lux-select-panel mat-option{border-left:0;box-sizing:border-box}.lux-select-panel mat-option.mat-selected{background-color:rgba(112,141,170,.2)!important;position:relative;border-radius:4px}.lux-select-panel mat-option.mat-selected:after{content:'';left:0;width:6px;top:0;bottom:0;position:absolute;border-left:6px solid #0073b3;border-radius:4px 0 0 4px}.lux-select-panel mat-option:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}.lux-select-panel mat-option.mat-active,.lux-select-panel mat-option:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-button button:not([disabled]) .mat-button-focus-overlay{display:none}lux-button button:not([disabled]):not(.mat-fab):not(.mat-raised-button):focus{background-color:rgba(112,141,170,.2)!important}lux-button button:not([disabled]):not(.mat-fab):not(.mat-raised-button):hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-button button:not([disabled]).mat-fab:focus,lux-button button:not([disabled]).mat-raised-button:focus{background-color:rgba(112,141,170,.2)!important}lux-button button:not([disabled]).mat-fab:focus.mat-accent,lux-button button:not([disabled]).mat-raised-button:focus.mat-accent{background-color:#b6d184!important}lux-button button:not([disabled]).mat-fab:focus.mat-warn,lux-button button:not([disabled]).mat-raised-button:focus.mat-warn{background-color:#ea2524!important}lux-button button:not([disabled]).mat-fab:focus.mat-primary,lux-button button:not([disabled]).mat-raised-button:focus.mat-primary{background-color:#4b82ba!important}.lux-autocomplete-panel mat-option{border-left:0;box-sizing:border-box}.lux-autocomplete-panel mat-option:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}.lux-autocomplete-panel mat-option.mat-active,.lux-autocomplete-panel mat-option:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-tabs mat-ink-bar{background-color:#0073b3!important}lux-tabs .mat-tab-label:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}lux-panel mat-expansion-panel-header:hover,lux-stepper mat-step-header:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-panel mat-expansion-panel-header:focus,lux-stepper mat-step-header:focus,lux-stepper mat-step-header[aria-selected=true],lux-tile mat-card:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}lux-master-detail lux-master-header .lux-master-header-collapse button.lux-button:not(.mat-fab):not(.mat-raised-button):focus{background-color:rgba(0,0,0,.2)!important}lux-file-list .lux-file-list{border:4px solid transparent}lux-file-list .lux-file-list:focus{outline-width:0;border:4px solid rgba(112,141,170,.2)!important}lux-file-list .lux-file-list .lux-file-list-entry{border:4px solid transparent}lux-file-list .lux-file-list .lux-file-list-entry:focus{outline-width:0;border:4px solid rgba(112,141,170,.2)!important}lux-file-list .lux-file-list mat-card{margin:4px}.lux-menu-panel .lux-menu-item:not([disabled=true]):focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}.lux-menu-panel .lux-menu-item:not([disabled=true]):hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}lux-dialog-structure lux-dialog-content:focus,lux-dialog-structure lux-dialog-title:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}example-root .example-base-components-list .example-component-list-item,example-root .example-base-components-list mat-expansion-panel-header{box-sizing:border-box}example-root .example-base-components-list .example-component-list-item.example-component-list-item-selected,example-root .example-base-components-list mat-expansion-panel-header.example-component-list-item-selected{background-color:rgba(112,141,170,.2)!important;position:relative;border-radius:4px}example-root .example-base-components-list .example-component-list-item.example-component-list-item-selected:after,example-root .example-base-components-list mat-expansion-panel-header.example-component-list-item-selected:after{content:'';left:0;width:6px;top:0;bottom:0;position:absolute;border-left:6px solid #0073b3;border-radius:4px 0 0 4px}example-root .example-base-components-list .example-component-list-item:focus,example-root .example-base-components-list mat-expansion-panel-header:focus{outline-width:0!important;outline-style:unset;background-color:rgba(112,141,170,.2)!important;border-radius:4px}example-root .example-base-components-list .example-component-list-item:hover,example-root .example-base-components-list mat-expansion-panel-header:hover{background-color:rgba(0,0,0,.2)!important;border-radius:4px}.lux-app-container,body,html{height:100%}.lux-app-container{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex}body{-webkit-overflow-scrolling:touch}div{font-family:Roboto,Helvetica Neue,sans-serif}.cdk-overlay-backdrop.cdk-overlay-backdrop-showing.lux-file-preview-backdrop{background:#000;opacity:.8!important}lux-card.lux-card-grow{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;width:400px;min-width:0}lux-card.lux-card-grow mat-card,lux-card.lux-card-grow mat-card-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-width:0}.lux-crop{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.lux-label{color:rgba(0,0,0,.54);font-size:75%}.lux-hint{color:rgba(0,0,0,.6);font-size:12px}.lux-display-none{display:none}.lux-hidden{visibility:hidden}.lux-nowrap{white-space:nowrap}.lux-cursor{cursor:pointer}.lux-block-pointer-events{pointer-events:none}.lux-vertical-align-baseline{vertical-align:baseline!important}.lux-black-semi-transparent{color:rgba(0,0,0,.87)}.lux-semi-transparent{opacity:.6}.lux-overflow-y-hidden{overflow-y:hidden}.lux-overflow-y-auto{overflow-y:auto}.lux-overflow-wrap-break-word{overflow-wrap:break-word}.lux-bold{font-weight:700!important}.lux-uppercase{text-transform:uppercase!important}.lux-lowercase{text-transform:lowercase!important}.lux-hyphenate{overflow-wrap:break-word;word-wrap:break-word;word-break:normal;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow-x:auto}.lux-p-footer,.lux-p-header{padding:8px}.lux-snackbar{top:68px;right:8px;position:absolute;margin:0!important;min-width:unset!important;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.mat-snack-bar-handset .lux-snackbar{left:8px;width:auto!important}.lux-mt-0{margin-top:0}.lux-pt-0{padding-top:0}.lux-mt-1{margin-top:2px}.lux-pt-1{padding-top:2px}.lux-mt-2{margin-top:4px}.lux-pt-2{padding-top:4px}.lux-mt-3{margin-top:8px}.lux-pt-3{padding-top:8px}.lux-mt-4{margin-top:16px}.lux-pt-4{padding-top:16px}.lux-mb-0{margin-bottom:0}.lux-pb-0{padding-bottom:0}.lux-mb-1{margin-bottom:2px}.lux-pb-1{padding-bottom:2px}.lux-mb-2{margin-bottom:4px}.lux-pb-2{padding-bottom:4px}.lux-mb-3{margin-bottom:8px}.lux-pb-3{padding-bottom:8px}.lux-mb-4{margin-bottom:16px}.lux-pb-4{padding-bottom:16px}.lux-ml-0{margin-left:0}.lux-pl-0{padding-left:0}.lux-ml-1{margin-left:2px}.lux-pl-1{padding-left:2px}.lux-ml-2{margin-left:4px}.lux-pl-2{padding-left:4px}.lux-ml-3{margin-left:8px}.lux-pl-3{padding-left:8px}.lux-ml-4{margin-left:16px}.lux-pl-4{padding-left:16px}.lux-m-0{margin:0}.lux-mr-0{margin-right:0}.lux-p-0{padding:0}.lux-pr-0{padding-right:0}.lux-m-1{margin:2px}.lux-mr-1{margin-right:2px}.lux-p-1{padding:2px}.lux-pr-1{padding-right:2px}.lux-m-2{margin:4px}.lux-mr-2{margin-right:4px}.lux-p-2{padding:4px}.lux-pr-2{padding-right:4px}.lux-m-3{margin:8px}.lux-mr-3{margin-right:8px}.lux-p-3{padding:8px}.lux-pr-3{padding-right:8px}.lux-m-4{margin:16px}.lux-mr-4{margin-right:16px}.lux-p-4{padding:16px}.lux-pr-4{padding-right:16px}.lux-flex-layout-gap-10[style*=row]>:not(:last-child){margin-right:10px}.lux-flex-layout-gap-10[style*=column]>:not(:last-child){margin-bottom:10px}.lux-flex-layout-gap-20[style*=row]>:not(:last-child){margin-right:20px}.lux-flex-layout-gap-20[style*=column]>:not(:last-child){margin-bottom:20px}.lux-flex-layout-gap-30[style*=row]>:not(:last-child){margin-right:30px}.lux-flex-layout-gap-30[style*=column]>:not(:last-child){margin-bottom:30px}.lux-z-index-100{z-index:100}.lux-z-index-500{z-index:500}.lux-z-index-1000{z-index:1000}.lux-uppercase>lux-button .lux-button-label,lux-button.lux-uppercase .lux-button-label{text-transform:uppercase}.lux-bg-color-red{background:#b01211}.lux-bg-color-green{background:#95bc4c}.lux-bg-color-yellow{background:#ebc000}.lux-bg-color-blue{background:#335c85}.lux-bg-color-gray{background:#c8c8c8}.lux-bg-color-orange{background:#ec9c1b}.lux-bg-color-brown{background:#783f04}.lux-font-color-black{color:#000}.lux-font-color-white{color:#fff}.lux-badge-notification.mat-badge-large .mat-badge-content{font-size:15px}.lux-badge-notification.lux-badge-color-default .mat-badge-content{color:#000;background:#fff;border:1px solid rgba(0,0,0,.87)}:host{display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}:host.lux-file-highlight *,:host.lux-file-highlight ::ng-deep *{pointer-events:none}:host.lux-file-highlight:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;border:2px dashed rgba(0,0,0,.38);background:rgba(0,0,0,.12);border-radius:4px;pointer-events:none}:host lux-menu ::ng-deep .lux-menu-extended .lux-menu-trigger,:host lux-menu ::ng-deep .lux-menu-extended>lux-button{margin:0!important}:host lux-menu ::ng-deep i,:host lux-menu ::ng-deep mat-icon{width:auto!important}:host lux-menu ::ng-deep lux-button{cursor:pointer!important;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}:host lux-menu ::ng-deep lux-button ::ng-deep button{padding:0;width:45px;min-width:45px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}:host lux-menu ::ng-deep lux-button ::ng-deep button:focus{background:rgba(51,92,133,.1)}.lux-file-download-anchor,.lux-file-input{display:none}.lux-file-list{width:100%;border-radius:4px;position:relative}.lux-file-list lux-icon,.lux-file-list span{color:#bfbfbf}.lux-file-list lux-button ::ng-deep button:not([disabled]) .mat-button-focus-overlay{display:none}.lux-file-list .lux-file-icon-hint mat-hint,.lux-file-list lux-card-actions ::ng-deep{font-size:12px}.lux-file-list ::ng-deep mat-card-title lux-button{cursor:pointer!important;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.lux-file-list ::ng-deep mat-card-title lux-button ::ng-deep button{padding:0;width:45px;min-width:45px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.lux-file-list ::ng-deep mat-card-title lux-button ::ng-deep button:focus{background:rgba(51,92,133,.1)}.lux-file-list ::ng-deep mat-card-title>div{min-height:45px}.lux-file-list ::ng-deep mat-card-title .lux-card-title-container{color:#335c85}.lux-file-list .lux-file-list-entries .lux-file-list-entry{min-height:60px}.lux-file-list .lux-file-list-entries .lux-file-list-entry .lux-file-list-entry-label{-ms-word-break:break-all;word-break:break-all}.lux-file-list.lux-file-list-disabled{pointer-events:none}.lux-file-list.lux-file-list-disabled ::ng-deep i,.lux-file-list.lux-file-list-disabled ::ng-deep mat-card-content,.lux-file-list.lux-file-list-disabled ::ng-deep mat-card-title *,.lux-file-list.lux-file-list-disabled ::ng-deep span{color:rgba(0,0,0,.26)}.lux-file-list.lux-file-list-disabled .lux-file-icon-hint span{-webkit-text-decoration-color:rgba(0,0,0,.26)!important;text-decoration-color:rgba(0,0,0,.26)!important}"]
    }),
    tslib_1.__param(0, Optional()),
    tslib_1.__metadata("design:paramtypes", [ControlContainer,
        ChangeDetectorRef,
        LuxConsoleService,
        HttpClient,
        LiveAnnouncer,
        LuxComponentsConfigService])
], LuxFileListComponent);
export { LuxFileListComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LWZpbGUtbGlzdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWhrLWdmaS9sdXgtY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kdWxlcy9sdXgtZm9ybS9sdXgtZmlsZS9sdXgtZmlsZS1saXN0L2x1eC1maWxlLWxpc3QuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQ0wsZ0JBQWdCLEVBQ2hCLGFBQWEsRUFDYixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixLQUFLLEVBQ0wsU0FBUyxFQUNULFFBQVEsRUFDUixTQUFTLEVBQ1QsU0FBUyxFQUNULFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQztBQUMxRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFDaEYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDRDQUE0QyxDQUFDO0FBSS9FLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQzFHLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQU9uRixJQUFhLG9CQUFvQixHQUFqQyxNQUFhLG9CQUFxQixTQUFRLGVBQWU7SUE2RHZELFlBQ2MsZ0JBQWtDLEVBQzlDLEdBQXNCLEVBQ3RCLE1BQXlCLEVBQ3pCLElBQWdCLEVBQ2hCLGFBQTRCLEVBQzVCLE1BQWtDO1FBRWxDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFsRTFELDJCQUFzQixHQUE2QjtZQUMzRCxRQUFRLEVBQUUsS0FBSztZQUNmLGNBQWMsRUFBRSxLQUFLO1lBQ3JCLE1BQU0sRUFBRSxLQUFLO1lBQ2IsWUFBWSxFQUFFLEtBQUs7WUFDbkIsUUFBUSxFQUFFLHlCQUF5QjtZQUNuQyxjQUFjLEVBQUUseUJBQXlCO1lBQ3pDLEtBQUssRUFBRSxXQUFXO1lBQ2xCLFdBQVcsRUFBRSx3QkFBd0I7U0FDdEMsQ0FBQztRQUNRLDJCQUFzQixHQUE2QjtZQUMzRCxRQUFRLEVBQUUsS0FBSztZQUNmLGNBQWMsRUFBRSxLQUFLO1lBQ3JCLE1BQU0sRUFBRSxLQUFLO1lBQ2IsWUFBWSxFQUFFLEtBQUs7WUFDbkIsUUFBUSxFQUFFLGNBQWM7WUFDeEIsY0FBYyxFQUFFLGNBQWM7WUFDOUIsS0FBSyxFQUFFLFNBQVM7WUFDaEIsV0FBVyxFQUFFLHdCQUF3QjtTQUN0QyxDQUFDO1FBRUYsY0FBUyxHQUFhLEVBQUUsQ0FBQztRQUV6QixhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBQ2IsdUJBQWtCLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLHNCQUFpQixHQUFHLEtBQUssQ0FBQztRQUMxQix3QkFBbUIsR0FBRyxLQUFLLENBQUM7UUFDNUIsMEJBQXFCLEdBQUcsS0FBSyxDQUFDO1FBQzlCLHdCQUFtQixHQUFHLEtBQUssQ0FBQztRQU1uQixtQkFBYyxHQUFZLElBQUksQ0FBQztRQUMvQixnQkFBVyxHQUFZLElBQUksQ0FBQztRQUM1QiwwQkFBcUIsR0FBVyx5QkFBeUIsQ0FBQztJQStCbkUsQ0FBQztJQTdCRCxJQUFJLHFCQUFxQjtRQUN2QixPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztJQUNyQyxDQUFDO0lBRVEsSUFBSSxxQkFBcUIsQ0FBQyxNQUFnQztRQUNqRSxJQUFJLE1BQU0sRUFBRTtZQUNWLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxNQUFNLENBQUM7U0FDdEM7SUFDSCxDQUFDO0lBRUQsSUFBSSxxQkFBcUI7UUFDdkIsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUM7SUFDckMsQ0FBQztJQUVRLElBQUkscUJBQXFCLENBQUMsTUFBZ0M7UUFDakUsSUFBSSxNQUFNLEVBQUU7WUFDVixJQUFJLENBQUMsc0JBQXNCLEdBQUcsTUFBTSxDQUFDO1NBQ3RDO0lBQ0gsQ0FBQztJQWFELGVBQWU7UUFDYixJQUFJLENBQUMsMkJBQTJCLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRTtZQUN6RSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUM1QixDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFTyxrQkFBa0I7UUFDeEIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBRXBCLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUN2QixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7U0FDbkI7SUFDSCxDQUFDO0lBRUQsV0FBVztRQUNULEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVwQixJQUFJLElBQUksQ0FBQywyQkFBMkIsRUFBRTtZQUNwQyxJQUFJLENBQUMsMkJBQTJCLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDaEQ7SUFDSCxDQUFDO0lBRUQsdUJBQXVCLENBQUMsS0FBYTtRQUNuQyxPQUFPLENBQ0wsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxtQkFBbUIsQ0FDaEgsQ0FBQztJQUNKLENBQUM7SUFFRDs7O09BR0c7SUFDSCxVQUFVLENBQUMsS0FBYTtRQUN0QixJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFL0IsNkdBQTZHO1FBQzdHLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1lBQ25ELENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxFQUFFLENBQUMsV0FBVyxLQUFLLEtBQUssQ0FBQztZQUM1RSxDQUFDLENBQUMsU0FBUyxDQUFDO1FBRWQseURBQXlEO1FBQ3pELElBQUksQ0FBQyxrQkFBa0IsQ0FDckIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FDdEcsQ0FBQztRQUVGLGtHQUFrRztRQUNsRyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FDN0IsR0FBRyxFQUFFO1lBQ0gsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFFBQVEsSUFBSSxRQUFRLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7WUFDbkYsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDaEMsQ0FBQyxFQUNELEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUMxQyxDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMscUJBQXFCLENBQUMsT0FBTyxFQUFFO1lBQ3RDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUN0QztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSCxXQUFXLENBQUMsS0FBd0I7UUFDbEMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNqQyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQywwQkFBMEIsR0FBRyxJQUFJLENBQUM7UUFDdkMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBRXBELElBQUksQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDaEMsSUFBSSxDQUFDLDBCQUEwQixHQUFHLEtBQUssQ0FBQztZQUN4QyxPQUFPO1NBQ1I7UUFFRCxtREFBbUQ7UUFDbkQsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLCtDQUErQztZQUMvQyxJQUFJLGtCQUFrQixHQUFHLEVBQUUsQ0FBQztZQUM1QixNQUFNLG1CQUFtQixHQUFHLElBQUksR0FBRyxFQUFnQixDQUFDO1lBQ3BELElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFO2dCQUN6QixLQUFLLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDMUIsa0JBQWtCLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUM1RyxxQ0FBcUM7Z0JBQ3JDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFVLEVBQUUsRUFBRTtvQkFDM0IsTUFBTSxLQUFLLEdBQUcsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBMkIsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQzVHLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxFQUFFO3dCQUNkLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7cUJBQ3RDO2dCQUNILENBQUMsQ0FBQyxDQUFDO2FBQ0o7WUFFRCxzR0FBc0c7WUFDdEcsMkRBQTJEO1lBQzNELElBQ0UsQ0FBQyxJQUFJLENBQUMsV0FBVztnQkFDakIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixJQUFJLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO29CQUMzQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztvQkFDM0QsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLElBQUksbUJBQW1CLENBQUMsSUFBSSxLQUFLLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUN2RTtnQkFDQSxJQUFJLENBQUMsb0JBQW9CLENBQUM7b0JBQ3hCLEtBQUssRUFBRSxpQkFBaUIsQ0FBQyxpQkFBaUI7b0JBQzFDLFNBQVMsRUFBRSxJQUFJLENBQUMsMkJBQTJCLEVBQUU7b0JBQzdDLElBQUksRUFBRSxJQUFJO2lCQUNYLENBQUMsQ0FBQztnQkFDSCxPQUFPO2FBQ1I7WUFFRCxJQUFJLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUNsQyxDQUFDLFFBQTBCLEVBQUUsRUFBRTtnQkFDN0IsTUFBTSxpQkFBaUIsR0FBRyxrQkFBa0IsQ0FBQztnQkFFN0MsMERBQTBEO2dCQUMxRCxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFVLEVBQUUsS0FBYSxFQUFFLEVBQUU7b0JBQ3hELE1BQU0scUJBQXFCLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQXVCLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUNyRyxrREFBa0Q7b0JBQ2xELFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsT0FBTyxLQUFLLHFCQUFxQixDQUFDLENBQUM7b0JBQ3pFLGtDQUFrQztvQkFDbEMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcscUJBQXFCLENBQUM7Z0JBQ25ELENBQUMsQ0FBQyxDQUFDO2dCQUNILG9DQUFvQztnQkFDcEMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUM7Z0JBRXBDLElBQUksQ0FBQyxnQkFBZ0I7b0JBQ25CLGlCQUFpQixJQUFJLGlCQUFpQixDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDakcsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7WUFDaEMsQ0FBQyxFQUNELEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUMxQyxDQUFDO1FBQ0osQ0FBQyxFQUFFLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLFVBQVU7UUFDaEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFnQixFQUFFLEtBQWEsRUFBRSxFQUFFO1lBQzNELE1BQU0sVUFBVSxHQUFtQyxJQUFJLENBQUMsYUFBYyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM1RixJQUFJLFVBQVUsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7Z0JBQ3ZDLE1BQU0saUJBQWlCLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7b0JBQzVELENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTztvQkFDdEMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUM7Z0JBQ2xDLElBQUksaUJBQWlCLFlBQVksSUFBSSxFQUFFO29CQUNyQyxJQUFJLENBQUMsUUFBUSxDQUFPLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBZSxFQUFFLEVBQUU7d0JBQzlELFVBQVUsQ0FBQyxHQUFHLEdBQUcsT0FBTyxDQUFDO29CQUMzQixDQUFDLENBQUMsQ0FBQztpQkFDSjtxQkFBTTtvQkFDTCxVQUFVLENBQUMsR0FBRyxHQUFHLGlCQUFpQixDQUFDO2lCQUNwQzthQUNGO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxZQUFZO1FBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDMUIsT0FBTztTQUNSO1FBRUQsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDcEIsTUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDO1FBRXpCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQ3pDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7U0FDM0M7YUFBTTtZQUNMLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztTQUM5QztRQUNELGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxZQUE0QixFQUFFLEVBQUU7WUFDckQsSUFBSSxXQUFXLEdBQUcsYUFBYSxDQUFDO1lBQ2hDLElBQUksWUFBWSxDQUFDLElBQUksRUFBRTtnQkFDckIsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtvQkFDM0MsV0FBVyxHQUFHLG1CQUFtQixDQUFDO2lCQUNuQztxQkFBTSxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO29CQUNoRCxXQUFXLEdBQUcsaUJBQWlCLENBQUM7aUJBQ2pDO3FCQUFNLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7b0JBQ3hELFdBQVcsR0FBRyxtQkFBbUIsQ0FBQztpQkFDbkM7cUJBQU0sSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO29CQUMzRCxXQUFXLEdBQUcsdUJBQXVCLENBQUM7aUJBQ3ZDO3FCQUFNLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7b0JBQ2pELFdBQVcsR0FBRyxrQkFBa0IsQ0FBQztpQkFDbEM7YUFDRjtZQUNELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUMzQixDQUFDO0lBRUQsa0JBQWtCO1FBQ2hCLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRCxPQUFPLENBQUMsTUFBVztRQUNqQixPQUFPLE1BQU0sSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFTyxtQkFBbUI7UUFDekIsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUU7WUFDMUQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQztZQUNyRSxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssV0FBVyxFQUFFO2dCQUNqQyxJQUFJLENBQUMsUUFBUSxHQUFHLFdBQVcsQ0FBQztnQkFFNUIsSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLEdBQUcsRUFBRTtvQkFDeEIsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEdBQUcsQ0FBQztvQkFDOUIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQztvQkFDOUIsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQztvQkFDaEMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQztvQkFDbEMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQztpQkFDakM7cUJBQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLEdBQUcsRUFBRTtvQkFDL0IsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEdBQUcsQ0FBQztvQkFDOUIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLEtBQUssQ0FBQztvQkFDL0IsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQztvQkFDakMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQztvQkFDbEMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQztpQkFDakM7cUJBQU07b0JBQ0wsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEVBQUUsQ0FBQztvQkFDN0IsSUFBSSxDQUFDLGlCQUFpQixHQUFHLEtBQUssQ0FBQztvQkFDL0IsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQztvQkFDakMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQztvQkFDbkMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQztpQkFDbEM7Z0JBRUQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQzthQUMxQjtTQUNGO0lBQ0gsQ0FBQztJQUVELDRCQUE0QjtJQUVsQixvQkFBb0IsQ0FBQyxLQUFVLEVBQUUsTUFBVztRQUNwRCxJQUFJLE1BQU0sQ0FBQyxRQUFRLEVBQUU7WUFDbkIsT0FBTyxpREFBaUQsQ0FBQztTQUMxRDtRQUNELE9BQU8sS0FBSyxDQUFDLG9CQUFvQixDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRVMsb0JBQW9CLENBQUMsSUFBb0I7UUFDakQsS0FBSyxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBRWpDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFUyxzQkFBc0I7UUFDOUIsS0FBSyxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDL0IsSUFBSSxDQUFDLFdBQVcsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO1FBRTFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxhQUFhLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztJQUN4RCxDQUFDO0NBR0YsQ0FBQTs7WUF6UWlDLGdCQUFnQix1QkFBN0MsUUFBUTtZQUNKLGlCQUFpQjtZQUNkLGlCQUFpQjtZQUNuQixVQUFVO1lBQ0QsYUFBYTtZQUNwQiwwQkFBMEI7O0FBbENhO0lBQWhELFlBQVksQ0FBQyxXQUFXLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUM7c0NBQWMsU0FBUzt5REFBYTtBQUNqQjtJQUFsRSxTQUFTLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQztzQ0FBd0IsVUFBVTttRUFBQztBQUNwQztJQUFoRSxTQUFTLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQztzQ0FBVyxVQUFVO3NEQUFDO0FBRTdFO0lBQVIsS0FBSyxFQUFFOzs0REFBZ0M7QUFDL0I7SUFBUixLQUFLLEVBQUU7O3lEQUE2QjtBQUM1QjtJQUFSLEtBQUssRUFBRTs7bUVBQTJEO0FBTTFEO0lBQVIsS0FBSyxFQUFFOzs7aUVBSVA7QUFNUTtJQUFSLEtBQUssRUFBRTs7O2lFQUlQO0FBM0RVLG9CQUFvQjtJQUxoQyxTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsZUFBZTtRQUN6QixxbVJBQTZDOztLQUU5QyxDQUFDO0lBK0RHLG1CQUFBLFFBQVEsRUFBRSxDQUFBOzZDQUFtQixnQkFBZ0I7UUFDekMsaUJBQWlCO1FBQ2QsaUJBQWlCO1FBQ25CLFVBQVU7UUFDRCxhQUFhO1FBQ3BCLDBCQUEwQjtHQW5FekIsb0JBQW9CLENBdVVoQztTQXZVWSxvQkFBb0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdDaGVja2VkLFxuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBPcHRpb25hbCxcbiAgUXVlcnlMaXN0LFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdDaGlsZHJlblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xDb250YWluZXIgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBMdXhDb25zb2xlU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL2x1eC11dGlsL2x1eC1jb25zb2xlLnNlcnZpY2UnO1xuaW1wb3J0IHsgTHV4Rm9ybUZpbGVCYXNlIH0gZnJvbSAnLi4vLi4vbHV4LWZvcm0tbW9kZWwvbHV4LWZvcm0tZmlsZS1iYXNlLmNsYXNzJztcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBMdXhGaWxlRXJyb3JDYXVzZSB9IGZyb20gJy4uL2x1eC1maWxlLW1vZGVsL2x1eC1maWxlLWVycm9yLmludGVyZmFjZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IElMdXhGaWxlTGlzdEFjdGlvbkNvbmZpZyB9IGZyb20gJy4uL2x1eC1maWxlLW1vZGVsL2x1eC1maWxlLWxpc3QtYWN0aW9uLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgSUx1eEZpbGVPYmplY3QgfSBmcm9tICcuLi9sdXgtZmlsZS1tb2RlbC9sdXgtZmlsZS1vYmplY3QuaW50ZXJmYWNlJztcbmltcG9ydCB7IEx1eENvbXBvbmVudHNDb25maWdTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vbHV4LWNvbXBvbmVudHMtY29uZmlnL2x1eC1jb21wb25lbnRzLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7IExpdmVBbm5vdW5jZXIgfSBmcm9tICdAYW5ndWxhci9jZGsvYTExeSc7XG5pbXBvcnQgeyBMdXhDYXJkQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vbHV4LWxheW91dC9sdXgtY2FyZC9sdXgtY2FyZC5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdsdXgtZmlsZS1saXN0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL2x1eC1maWxlLWxpc3QuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9sdXgtZmlsZS1saXN0LmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTHV4RmlsZUxpc3RDb21wb25lbnQgZXh0ZW5kcyBMdXhGb3JtRmlsZUJhc2UgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3kge1xuICBwcml2YXRlIF9maWxlRW50cnlOb2Rlc0NoYW5nZVN1YnNjcjogU3Vic2NyaXB0aW9uO1xuXG4gIHByb3RlY3RlZCBfbHV4VXBsb2FkQWN0aW9uQ29uZmlnOiBJTHV4RmlsZUxpc3RBY3Rpb25Db25maWcgPSB7XG4gICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgIGRpc2FibGVkSGVhZGVyOiBmYWxzZSxcbiAgICBoaWRkZW46IGZhbHNlLFxuICAgIGhpZGRlbkhlYWRlcjogZmFsc2UsXG4gICAgaWNvbk5hbWU6ICdmYXMgZmEtY2xvdWQtdXBsb2FkLWFsdCcsXG4gICAgaWNvbk5hbWVIZWFkZXI6ICdmYXMgZmEtY2xvdWQtdXBsb2FkLWFsdCcsXG4gICAgbGFiZWw6ICdIb2NobGFkZW4nLFxuICAgIGxhYmVsSGVhZGVyOiAnTmV1ZSBEYXRlaWVuIGhvY2hsYWRlbidcbiAgfTtcbiAgcHJvdGVjdGVkIF9sdXhEZWxldGVBY3Rpb25Db25maWc6IElMdXhGaWxlTGlzdEFjdGlvbkNvbmZpZyA9IHtcbiAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgZGlzYWJsZWRIZWFkZXI6IGZhbHNlLFxuICAgIGhpZGRlbjogZmFsc2UsXG4gICAgaGlkZGVuSGVhZGVyOiBmYWxzZSxcbiAgICBpY29uTmFtZTogJ2ZhcyBmYS10cmFzaCcsXG4gICAgaWNvbk5hbWVIZWFkZXI6ICdmYXMgZmEtdHJhc2gnLFxuICAgIGxhYmVsOiAnTMO2c2NoZW4nLFxuICAgIGxhYmVsSGVhZGVyOiAnQWxsZSBEYXRlaWVuIGVudGZlcm5lbidcbiAgfTtcblxuICBmaWxlSWNvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgcm93V2lkdGggPSAwO1xuICBpY29uQWN0aW9uQmFyV2lkdGggPSA1MDtcbiAgYWx3YXlzVmlzaWJsZVZpZXcgPSBmYWxzZTtcbiAgYWx3YXlzVmlzaWJsZVVwbG9hZCA9IGZhbHNlO1xuICBhbHdheXNWaXNpYmxlRG93bmxvYWQgPSBmYWxzZTtcbiAgYWx3YXlzVmlzaWJsZURlbGV0ZSA9IGZhbHNlO1xuXG4gIEBWaWV3Q2hpbGRyZW4oJ2ZpbGVFbnRyeScsIHsgcmVhZDogRWxlbWVudFJlZiB9KSBmaWxlRW50cmllczogUXVlcnlMaXN0PEVsZW1lbnRSZWY+O1xuICBAVmlld0NoaWxkKCdmaWxldXBsb2FkU2luZ2xlJywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSkgZmlsZXVwbG9hZFNpbmdsZUlucHV0OiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKEx1eENhcmRDb21wb25lbnQsIHsgcmVhZDogRWxlbWVudFJlZiwgc3RhdGljOiB0cnVlIH0pIGZpbGVDYXJkOiBFbGVtZW50UmVmO1xuXG4gIEBJbnB1dCgpIGx1eFNob3dQcmV2aWV3OiBib29sZWFuID0gdHJ1ZTtcbiAgQElucHV0KCkgbHV4TXVsdGlwbGU6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBsdXhCYWNrZ3JvdW5kSWNvbk5hbWU6IHN0cmluZyA9ICdmYXMgZmEtY2xvdWQtdXBsb2FkLWFsdCc7XG5cbiAgZ2V0IGx1eFVwbG9hZEFjdGlvbkNvbmZpZygpOiBJTHV4RmlsZUxpc3RBY3Rpb25Db25maWcge1xuICAgIHJldHVybiB0aGlzLl9sdXhVcGxvYWRBY3Rpb25Db25maWc7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgbHV4VXBsb2FkQWN0aW9uQ29uZmlnKGNvbmZpZzogSUx1eEZpbGVMaXN0QWN0aW9uQ29uZmlnKSB7XG4gICAgaWYgKGNvbmZpZykge1xuICAgICAgdGhpcy5fbHV4VXBsb2FkQWN0aW9uQ29uZmlnID0gY29uZmlnO1xuICAgIH1cbiAgfVxuXG4gIGdldCBsdXhEZWxldGVBY3Rpb25Db25maWcoKTogSUx1eEZpbGVMaXN0QWN0aW9uQ29uZmlnIHtcbiAgICByZXR1cm4gdGhpcy5fbHV4RGVsZXRlQWN0aW9uQ29uZmlnO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGx1eERlbGV0ZUFjdGlvbkNvbmZpZyhjb25maWc6IElMdXhGaWxlTGlzdEFjdGlvbkNvbmZpZykge1xuICAgIGlmIChjb25maWcpIHtcbiAgICAgIHRoaXMuX2x1eERlbGV0ZUFjdGlvbkNvbmZpZyA9IGNvbmZpZztcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICBAT3B0aW9uYWwoKSBjb250cm9sQ29udGFpbmVyOiBDb250cm9sQ29udGFpbmVyLFxuICAgIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgbG9nZ2VyOiBMdXhDb25zb2xlU2VydmljZSxcbiAgICBodHRwOiBIdHRwQ2xpZW50LFxuICAgIGxpdmVBbm5vdW5jZXI6IExpdmVBbm5vdW5jZXIsXG4gICAgY29uZmlnOiBMdXhDb21wb25lbnRzQ29uZmlnU2VydmljZVxuICApIHtcbiAgICBzdXBlcihjb250cm9sQ29udGFpbmVyLCBjZHIsIGxvZ2dlciwgY29uZmlnLCBodHRwLCBsaXZlQW5ub3VuY2VyKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLl9maWxlRW50cnlOb2Rlc0NoYW5nZVN1YnNjciA9IHRoaXMuZmlsZUVudHJpZXMuY2hhbmdlcy5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy51cGRhdGVJY29uQW5kSW1hZ2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMudXBkYXRlSWNvbkFuZEltYWdlKCk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUljb25BbmRJbWFnZSgpIHtcbiAgICB0aGlzLnNldEZpbGVJY29ucygpO1xuXG4gICAgaWYgKHRoaXMubHV4U2hvd1ByZXZpZXcpIHtcbiAgICAgIHRoaXMuc2V0SW1nU3JjcygpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHN1cGVyLm5nT25EZXN0cm95KCk7XG5cbiAgICBpZiAodGhpcy5fZmlsZUVudHJ5Tm9kZXNDaGFuZ2VTdWJzY3IpIHtcbiAgICAgIHRoaXMuX2ZpbGVFbnRyeU5vZGVzQ2hhbmdlU3Vic2NyLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgc2hvdWxkRGlzcGxheVByZXZpZXdJbWcoaW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmx1eFNob3dQcmV2aWV3ICYmIHRoaXMuZmlsZUljb25zICYmIHRoaXMuZmlsZUljb25zW2luZGV4XSAmJiB0aGlzLmZpbGVJY29uc1tpbmRleF0gPT09ICdmYXMgZmEtZmlsZS1pbWFnZSdcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEVudGZlcm50IGVpbmUgRGF0ZWkgYXVzIGRlbiBzZWxla3RpZXJ0ZW4gRGF0ZWllbi5cbiAgICogQHBhcmFtIGluZGV4XG4gICAqL1xuICByZW1vdmVGaWxlKGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmZvcm1Db250cm9sLm1hcmtBc1RvdWNoZWQoKTtcbiAgICB0aGlzLmZvcm1Db250cm9sLm1hcmtBc0RpcnR5KCk7XG5cbiAgICAvLyBXZW5uIG1laHJlcmUgRGF0ZWllbiBzZWxla3RpZXJ0IHNpbmQsIGRpZXNlIG5hY2ggZGVyIGVudGZlcm50ZW4gRGF0ZWkgZmlsdGVybiBhbnNvbnN0ZW4gXCJ1bmRlZmluZWRcIiBudXR6ZW5cbiAgICBjb25zdCBuZXdGaWxlcyA9IEFycmF5LmlzQXJyYXkodGhpcy5sdXhTZWxlY3RlZEZpbGVzKVxuICAgICAgPyB0aGlzLmx1eFNlbGVjdGVkRmlsZXMuZmlsdGVyKChmaWxlLCBzZWFyY2hJbmRleCkgPT4gc2VhcmNoSW5kZXggIT09IGluZGV4KVxuICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICAvLyBWaWEgTGl2ZUFubm91bmNlciBtaXR0ZWlsZW4gd2VsY2hlIERhdGVpIGVudGZlcm50IHdpcmRcbiAgICB0aGlzLmFubm91bmNlRmlsZVJlbW92ZShcbiAgICAgIEFycmF5LmlzQXJyYXkodGhpcy5sdXhTZWxlY3RlZEZpbGVzKSA/IHRoaXMubHV4U2VsZWN0ZWRGaWxlc1tpbmRleF0ubmFtZSA6IHRoaXMubHV4U2VsZWN0ZWRGaWxlcy5uYW1lXG4gICAgKTtcblxuICAgIC8vIFdpciBlbnRmZXJuZW4gaGllciBudXIgZWluZSBEYXRlaSwgZGVzaGFsYiBpc3QgZGFzIG5ldWUgQXVzbGVzZW4gZGVyIEJhc2U2NC1TdHJpbmdzIG5pY2h0IG7DtnRpZ1xuICAgIHRoaXMudXBsb2FkRmlsZXMobmV3RmlsZXMpLnRoZW4oXG4gICAgICAoKSA9PiB7XG4gICAgICAgIHRoaXMubHV4U2VsZWN0ZWRGaWxlcyA9IG5ld0ZpbGVzICYmIG5ld0ZpbGVzLmxlbmd0aCA9PT0gMSA/IG5ld0ZpbGVzWzBdIDogbmV3RmlsZXM7XG4gICAgICAgIHRoaXMubm90aWZ5Rm9ybVZhbHVlQ2hhbmdlZCgpO1xuICAgICAgfSxcbiAgICAgIGVycm9yID0+IHRoaXMuc2V0Rm9ybUNvbnRyb2xFcnJvcnMoZXJyb3IpXG4gICAgKTtcbiAgICBpZiAodGhpcy5sdXhEZWxldGVBY3Rpb25Db25maWcub25DbGljaykge1xuICAgICAgdGhpcy5sdXhEZWxldGVBY3Rpb25Db25maWcub25DbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGw7xndCB3ZWl0ZXJlIERhdGVpZW4genUgZGVuIGJlcmVpdHMgdm9yaGFuZGVuZW4gaGluenUgYnp3LiBlcnNldHp0IGRpZXNlLlxuICAgKiBAcGFyYW0gZmlsZXNcbiAgICovXG4gIHNlbGVjdEZpbGVzKGZpbGVzOiBGaWxlTGlzdCB8IEZpbGVbXSkge1xuICAgIHRoaXMuZm9ybUNvbnRyb2wubWFya0FzVG91Y2hlZCgpO1xuICAgIHRoaXMuZm9ybUNvbnRyb2wubWFya0FzRGlydHkoKTtcbiAgICB0aGlzLmZvcmNlUHJvZ3Jlc3NJbmRldGVybWluYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmFubm91bmNlRmlsZVByb2Nlc3MoZmlsZXMgJiYgZmlsZXMubGVuZ3RoID4gMSk7XG5cbiAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5mb3JjZVByb2dyZXNzSW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFRpbWVvdXQsIHVtIEZsYWNrZXJuIGR1cmNoIFByb2dyZXNzIHp1IHZlcm1laWRlblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gUHLDvGZlbiBvYiBkaWUgRGF0ZWllbiBiZXJlaXRzIHZvcmhhbmRlbiBzaW5kXG4gICAgICBsZXQgc2VsZWN0ZWRGaWxlc0FycmF5ID0gW107XG4gICAgICBjb25zdCByZXBsYWNlYWJsZUZpbGVzTWFwID0gbmV3IE1hcDxudW1iZXIsIEZpbGU+KCk7XG4gICAgICBpZiAodGhpcy5sdXhTZWxlY3RlZEZpbGVzKSB7XG4gICAgICAgIGZpbGVzID0gQXJyYXkuZnJvbShmaWxlcyk7XG4gICAgICAgIHNlbGVjdGVkRmlsZXNBcnJheSA9IEFycmF5LmlzQXJyYXkodGhpcy5sdXhTZWxlY3RlZEZpbGVzKSA/IHRoaXMubHV4U2VsZWN0ZWRGaWxlcyA6IFt0aGlzLmx1eFNlbGVjdGVkRmlsZXNdO1xuICAgICAgICAvLyB6dSBlcnNldHplbmRlIEluZGl6ZXMgaGVyYXVzZmluZGVuXG4gICAgICAgIGZpbGVzLmZvckVhY2goKGZpbGU6IEZpbGUpID0+IHtcbiAgICAgICAgICBjb25zdCBpbmRleCA9IHNlbGVjdGVkRmlsZXNBcnJheS5maW5kSW5kZXgoKGNvbXBhcmVGaWxlOiBJTHV4RmlsZU9iamVjdCkgPT4gY29tcGFyZUZpbGUubmFtZSA9PT0gZmlsZS5uYW1lKTtcbiAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgcmVwbGFjZWFibGVGaWxlc01hcC5zZXQoaW5kZXgsIGZpbGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFdlbm4gbWVocmVyZSBEYXRlaWVuIHNlbGVrdGllcnQgc2luZCB1bmQgbHV4TXVsdGlwbGUgZGllcyB1bnRlcmJpbmRldCwgRmVobGVyIHdlcmZlbiB1bmQgRm4gYmVlbmRlblxuICAgICAgLy8gQXVzbmFobWUgaXN0LCB3ZW5uIGRpZSBEYXRlaWVuIG51ciBlcnNldHp0IHdlcmRlbiBzb2xsZW5cbiAgICAgIGlmIChcbiAgICAgICAgIXRoaXMubHV4TXVsdGlwbGUgJiZcbiAgICAgICAgKCghdGhpcy5sdXhTZWxlY3RlZEZpbGVzICYmIGZpbGVzLmxlbmd0aCA+IDEpIHx8XG4gICAgICAgICAgKHRoaXMubHV4U2VsZWN0ZWRGaWxlcyAmJiB0aGlzLmx1eFNlbGVjdGVkRmlsZXMubGVuZ3RoID4gMSkgfHxcbiAgICAgICAgICAodGhpcy5sdXhTZWxlY3RlZEZpbGVzICYmIHJlcGxhY2VhYmxlRmlsZXNNYXAuc2l6ZSAhPT0gZmlsZXMubGVuZ3RoKSlcbiAgICAgICkge1xuICAgICAgICB0aGlzLnNldEZvcm1Db250cm9sRXJyb3JzKHtcbiAgICAgICAgICBjYXVzZTogTHV4RmlsZUVycm9yQ2F1c2UuTXVsdGlwbGVGb3JiaWRkZW4sXG4gICAgICAgICAgZXhjZXB0aW9uOiB0aGlzLmdldE11bHRpcGxlRm9yYmlkZGVuTWVzc2FnZSgpLFxuICAgICAgICAgIGZpbGU6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZEZpbGVzKGZpbGVzKS50aGVuKFxuICAgICAgICAobmV3RmlsZXM6IElMdXhGaWxlT2JqZWN0W10pID0+IHtcbiAgICAgICAgICBjb25zdCB0ZW1wU2VsZWN0ZWRGaWxlcyA9IHNlbGVjdGVkRmlsZXNBcnJheTtcblxuICAgICAgICAgIC8vIGRpZSB6dSBlcnNldHplbmRlbiBEYXRlaWVuIGR1cmNoZ2VoZW4gdW5kIGFrdHVhbGlzaWVyZW5cbiAgICAgICAgICByZXBsYWNlYWJsZUZpbGVzTWFwLmZvckVhY2goKGZpbGU6IEZpbGUsIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VhYmxlRmlsZU9iamVjdCA9IG5ld0ZpbGVzLmZpbmQoKG5ld0ZpbGU6IElMdXhGaWxlT2JqZWN0KSA9PiBuZXdGaWxlLm5hbWUgPT09IGZpbGUubmFtZSk7XG4gICAgICAgICAgICAvLyBkYXMgZ2VmdW5kZW5lIE9iamVrdCBhdXMgZGVuIG5ld0ZpbGVzIGVudGZlcm5lblxuICAgICAgICAgICAgbmV3RmlsZXMgPSBuZXdGaWxlcy5maWx0ZXIobmV3RmlsZSA9PiBuZXdGaWxlICE9PSByZXBsYWNlYWJsZUZpbGVPYmplY3QpO1xuICAgICAgICAgICAgLy8gZGllIHNlbGVjdGVkRmlsZXMgYWt0dWFsaXNpZXJlblxuICAgICAgICAgICAgdGVtcFNlbGVjdGVkRmlsZXNbaW5kZXhdID0gcmVwbGFjZWFibGVGaWxlT2JqZWN0O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIGRpZSDDvGJyaWdlbiBuZXVlbiBEYXRlaWVuIGFuZsO8Z2VuXG4gICAgICAgICAgdGVtcFNlbGVjdGVkRmlsZXMucHVzaCguLi5uZXdGaWxlcyk7XG5cbiAgICAgICAgICB0aGlzLmx1eFNlbGVjdGVkRmlsZXMgPVxuICAgICAgICAgICAgdGVtcFNlbGVjdGVkRmlsZXMgJiYgdGVtcFNlbGVjdGVkRmlsZXMubGVuZ3RoID09PSAxID8gdGVtcFNlbGVjdGVkRmlsZXNbMF0gOiB0ZW1wU2VsZWN0ZWRGaWxlcztcbiAgICAgICAgICB0aGlzLm5vdGlmeUZvcm1WYWx1ZUNoYW5nZWQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3IgPT4gdGhpcy5zZXRGb3JtQ29udHJvbEVycm9ycyhlcnJvcilcbiAgICAgICk7XG4gICAgfSwgdGhpcy5kZWZhdWx0UmVhZEZpbGVEZWxheSk7XG4gIH1cblxuICAvKipcbiAgICogQWt0dWFsaXNpZXJ0IGRpZSBQcmV2aWV3LUJpbGRlciBmw7xyIGRpZSAoSW1hZ2UtKURhdGVpZW4uXG4gICAqXG4gICAqIEFrdHVhbGlzaWVydW5nIGFic2ljaHRsaWNoIHZpYSBGdW5rdGlvbiB1bmQgbmljaHQgUHJvcGVydHktQmluZGluZywgZGEgcG90ZW50aWVsbCBTdGFjay1TaXplIEZlaGxlciBhdWZ0cmV0ZW4sXG4gICAqIHdlbm4gKGdyb8OfZSkgQmFzZTY0LVN0cmluZ3MgZ2VnZW4gZGllIHNyYyBnZWJ1bmRlbiB3ZXJkZW4uXG4gICAqL1xuICBwcml2YXRlIHNldEltZ1NyY3MoKSB7XG4gICAgdGhpcy5maWxlRW50cmllcy5mb3JFYWNoKChpdGVtOiBFbGVtZW50UmVmLCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBpbWdFbGVtZW50OiBIVE1MSW1hZ2VFbGVtZW50ID0gKDxIVE1MRWxlbWVudD5pdGVtLm5hdGl2ZUVsZW1lbnQpLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuICAgICAgaWYgKGltZ0VsZW1lbnQgJiYgdGhpcy5sdXhTZWxlY3RlZEZpbGVzKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldEZpbGVDb250ZW50ID0gQXJyYXkuaXNBcnJheSh0aGlzLmx1eFNlbGVjdGVkRmlsZXMpXG4gICAgICAgICAgPyB0aGlzLmx1eFNlbGVjdGVkRmlsZXNbaW5kZXhdLmNvbnRlbnRcbiAgICAgICAgICA6IHRoaXMubHV4U2VsZWN0ZWRGaWxlcy5jb250ZW50O1xuICAgICAgICBpZiAodGFyZ2V0RmlsZUNvbnRlbnQgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgdGhpcy5yZWFkRmlsZSg8RmlsZT50YXJnZXRGaWxlQ29udGVudCkudGhlbigoY29udGVudDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBpbWdFbGVtZW50LnNyYyA9IGNvbnRlbnQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW1nRWxlbWVudC5zcmMgPSB0YXJnZXRGaWxlQ29udGVudDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHp0IGRpZSBJY29ucyBmw7xyIGRpZSBFbGVtZW50ZSBpbiBkZXIgQXVmbGlzdHVuZ1xuICAgKi9cbiAgcHJpdmF0ZSBzZXRGaWxlSWNvbnMoKSB7XG4gICAgaWYgKCF0aGlzLmx1eFNlbGVjdGVkRmlsZXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmZpbGVJY29ucyA9IFtdO1xuICAgIGNvbnN0IHNlbGVjdGVkRmlsZXMgPSBbXTtcblxuICAgIGlmICghQXJyYXkuaXNBcnJheSh0aGlzLmx1eFNlbGVjdGVkRmlsZXMpKSB7XG4gICAgICBzZWxlY3RlZEZpbGVzLnB1c2godGhpcy5sdXhTZWxlY3RlZEZpbGVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZWN0ZWRGaWxlcy5wdXNoKC4uLnRoaXMubHV4U2VsZWN0ZWRGaWxlcyk7XG4gICAgfVxuICAgIHNlbGVjdGVkRmlsZXMuZm9yRWFjaCgoc2VsZWN0ZWRGaWxlOiBJTHV4RmlsZU9iamVjdCkgPT4ge1xuICAgICAgbGV0IG5ld0ZpbGVJY29uID0gJ2ZhcyBmYS1maWxlJztcbiAgICAgIGlmIChzZWxlY3RlZEZpbGUudHlwZSkge1xuICAgICAgICBpZiAoc2VsZWN0ZWRGaWxlLnR5cGUuaW5kZXhPZignaW1hZ2UnKSA+IC0xKSB7XG4gICAgICAgICAgbmV3RmlsZUljb24gPSAnZmFzIGZhLWZpbGUtaW1hZ2UnO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkRmlsZS50eXBlLmluZGV4T2YoJ3BkZicpID4gLTEpIHtcbiAgICAgICAgICBuZXdGaWxlSWNvbiA9ICdmYXMgZmEtZmlsZS1wZGYnO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkRmlsZS50eXBlLmluZGV4T2YoJ3NwcmVhZHNoZWV0JykgPiAtMSkge1xuICAgICAgICAgIG5ld0ZpbGVJY29uID0gJ2ZhcyBmYS1maWxlLWV4Y2VsJztcbiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZEZpbGUudHlwZS5pbmRleE9mKCdvZmZpY2Vkb2N1bWVudCcpID4gLTEpIHtcbiAgICAgICAgICBuZXdGaWxlSWNvbiA9ICdmYXMgZmEtZmlsZS1zaWduYXR1cmUnO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkRmlsZS50eXBlLmluZGV4T2YoJ2pzb24nKSA+IC0xKSB7XG4gICAgICAgICAgbmV3RmlsZUljb24gPSAnZmFzIGZhLWZpbGUtY29kZSc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuZmlsZUljb25zLnB1c2gobmV3RmlsZUljb24pO1xuICAgIH0pO1xuICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpOiB2b2lkIHtcbiAgICB0aGlzLnJlc2l6ZUljb25BY3Rpb25CYXIoKTtcbiAgfVxuXG4gIGlzQXJyYXkob2JqZWN0OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gb2JqZWN0ICYmIEFycmF5LmlzQXJyYXkob2JqZWN0KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVzaXplSWNvbkFjdGlvbkJhcigpIHtcbiAgICBpZiAodGhpcy5maWxlRW50cmllcyAmJiB0aGlzLmZpbGVFbnRyaWVzLmZpcnN0ICYmIHRoaXMuY2RyKSB7XG4gICAgICBjb25zdCBuZXdSb3dXaWR0aCA9IHRoaXMuZmlsZUVudHJpZXMuZmlyc3QubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICAgIGlmICh0aGlzLnJvd1dpZHRoICE9PSBuZXdSb3dXaWR0aCkge1xuICAgICAgICB0aGlzLnJvd1dpZHRoID0gbmV3Um93V2lkdGg7XG5cbiAgICAgICAgaWYgKHRoaXMucm93V2lkdGggPj0gNTAwKSB7XG4gICAgICAgICAgdGhpcy5pY29uQWN0aW9uQmFyV2lkdGggPSAyMDA7XG4gICAgICAgICAgdGhpcy5hbHdheXNWaXNpYmxlVmlldyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5hbHdheXNWaXNpYmxlVXBsb2FkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmFsd2F5c1Zpc2libGVEb3dubG9hZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5hbHdheXNWaXNpYmxlRGVsZXRlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJvd1dpZHRoID49IDQwMCkge1xuICAgICAgICAgIHRoaXMuaWNvbkFjdGlvbkJhcldpZHRoID0gMTUwO1xuICAgICAgICAgIHRoaXMuYWx3YXlzVmlzaWJsZVZpZXcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmFsd2F5c1Zpc2libGVVcGxvYWQgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmFsd2F5c1Zpc2libGVEb3dubG9hZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5hbHdheXNWaXNpYmxlRGVsZXRlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmljb25BY3Rpb25CYXJXaWR0aCA9IDUwO1xuICAgICAgICAgIHRoaXMuYWx3YXlzVmlzaWJsZVZpZXcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmFsd2F5c1Zpc2libGVVcGxvYWQgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmFsd2F5c1Zpc2libGVEb3dubG9hZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuYWx3YXlzVmlzaWJsZURlbGV0ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIHJlZ2lvbiBPdmVycmlkZGVuIG1ldGhvZHNcblxuICBwcm90ZWN0ZWQgZXJyb3JNZXNzYWdlTW9kaWZpZXIodmFsdWU6IGFueSwgZXJyb3JzOiBhbnkpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGlmIChlcnJvcnMucmVxdWlyZWQpIHtcbiAgICAgIHJldHVybiAnRXMgbXVzcyBtaW5kZXN0ZW5zIGVpbmUgRGF0ZWkgYXVzZ2V3w6RobHQgd2VyZGVuJztcbiAgICB9XG4gICAgcmV0dXJuIHN1cGVyLmVycm9yTWVzc2FnZU1vZGlmaWVyKHZhbHVlLCBlcnJvcnMpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHRyaWdnZXJWaWV3RmlsZUNsaWNrKGZpbGU6IElMdXhGaWxlT2JqZWN0KSB7XG4gICAgc3VwZXIudHJpZ2dlclZpZXdGaWxlQ2xpY2soZmlsZSk7XG5cbiAgICB0aGlzLnVwZGF0ZUljb25BbmRJbWFnZSgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG5vdGlmeUZvcm1WYWx1ZUNoYW5nZWQoKSB7XG4gICAgc3VwZXIubm90aWZ5Rm9ybVZhbHVlQ2hhbmdlZCgpO1xuICAgIHRoaXMuZm9ybUNvbnRyb2wudXBkYXRlVmFsdWVBbmRWYWxpZGl0eSgpO1xuXG4gICAgdGhpcy5maWxldXBsb2FkU2luZ2xlSW5wdXQubmF0aXZlRWxlbWVudC52YWx1ZSA9IG51bGw7XG4gIH1cblxuICAvLyBlbmRyZWdpb25cbn1cbiJdfQ==
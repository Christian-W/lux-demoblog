import * as tslib_1 from "tslib";
import { Pipe } from '@angular/core';
export const day = 'Tagen', week = 'Wochen', month = 'Monaten', year = 'Jahren';
export const today = 'Heute', yesterday = 'Gestern', tomorrow = 'Morgen';
export const prefixFuture = 'in', prefixPast = 'vor';
export const MS_PER_DAY = 1000 * 60 * 60 * 24;
export const timeDeltas = [
    { name: year, days: 672, dayUnit: 336 },
    { name: month, days: 56, dayUnit: 28 },
    { name: week, days: 14, dayUnit: 7 },
    { name: day, days: 2, dayUnit: 1 }
];
export const timeDeltasRelative = [
    { name: tomorrow, days: 1 },
    { name: yesterday, days: -1 },
    { name: today, days: 0 }
];
let LuxRelativeTimestampPipe = class LuxRelativeTimestampPipe {
    transform(timestamp, defaultText = '', prefix) {
        if (!timestamp) {
            return defaultText;
        }
        const now = new Date();
        const then = new Date(timestamp);
        const delta = this.calcDiff(now, then);
        let timeName = null;
        for (const timeDelta of timeDeltas) {
            const tempDelta = delta < 0 ? delta * -1 : delta;
            if (tempDelta >= timeDelta.days) {
                if (!prefix) {
                    prefix = delta < 0 ? prefixPast : prefixFuture;
                }
                let timeUnits = timeDelta.name === day ? tempDelta : Math.floor(tempDelta / timeDelta.dayUnit);
                timeUnits *= timeUnits < 0 ? -1 : 1;
                timeName = `${prefix} ${timeUnits} ${timeDelta.name}`;
                break;
            }
        }
        if (timeName === null) {
            for (const timeDelta of timeDeltasRelative) {
                if (delta === timeDelta.days) {
                    timeName = timeDelta.name;
                    break;
                }
            }
        }
        return timeName;
    }
    calcDiff(a, b) {
        const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());
        const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());
        return Math.floor((utc2 - utc1) / MS_PER_DAY);
    }
};
LuxRelativeTimestampPipe = tslib_1.__decorate([
    Pipe({
        name: 'luxRelativeTimestamp'
    })
], LuxRelativeTimestampPipe);
export { LuxRelativeTimestampPipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LXJlbGF0aXZlLXRpbWVzdGFtcC5waXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGloay1nZmkvbHV4LWNvbXBvbmVudHMvIiwic291cmNlcyI6WyJzcmMvYXBwL21vZHVsZXMvbHV4LXBpcGVzL2x1eC1yZWxhdGl2ZS10aW1lc3RhbXAvbHV4LXJlbGF0aXZlLXRpbWVzdGFtcC5waXBlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQUVwRCxNQUFNLENBQUMsTUFBTSxHQUFHLEdBQUcsT0FBTyxFQUN4QixJQUFJLEdBQUcsUUFBUSxFQUNmLEtBQUssR0FBRyxTQUFTLEVBQ2pCLElBQUksR0FBRyxRQUFRLENBQUM7QUFDbEIsTUFBTSxDQUFDLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFDMUIsU0FBUyxHQUFHLFNBQVMsRUFDckIsUUFBUSxHQUFHLFFBQVEsQ0FBQztBQUN0QixNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsSUFBSSxFQUM5QixVQUFVLEdBQUcsS0FBSyxDQUFDO0FBRXJCLE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFFOUMsTUFBTSxDQUFDLE1BQU0sVUFBVSxHQUFHO0lBQ3hCLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUU7SUFDdkMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRTtJQUN0QyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFO0lBQ3BDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7Q0FDbkMsQ0FB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dCI6WyJpbXBvcnQgeyBQaXBlLCBQaXBlVHJhbnNmb3JtIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmV4cG9ydCBjb25zdCBkYXkgPSAnVGFnZW4nLFxuICB3ZWVrID0gJ1dvY2hlbicsXG4gIG1vbnRoID0gJ01vbmF0ZW4nLFxuICB5ZWFyID0gJ0phaHJlbic7XG5leHBvcnQgY29uc3QgdG9kYXkgPSAnSGV1dGUnLFxuICB5ZXN0ZXJkYXkgPSAnR2VzdGVybicsXG4gIHRvbW9ycm93ID0gJ01vcmdlbic7XG5leHBvcnQgY29uc3QgcHJlZml4RnV0dXJlID0gJ2luJyxcbiAgcHJlZml4UGFzdCA9ICd2b3InO1xuXG5leHBvcnQgY29uc3QgTVNfUEVSX0RBWSA9IDEwMDAgKiA2MCAqIDYwICogMjQ7XG5cbmV4cG9ydCBjb25zdCB0aW1lRGVsdGFzID0gW1xuICB7IG5hbWU6IHllYXIsIGRheXM6IDY3MiwgZGF5VW5pdDogMzM2IH0sXG4gIHsgbmFtZTogbW9udGgsIGRheXM6IDU2LCBkYXlVbml0OiAyOCB9LFxuICB7IG5hbWU6IHdlZWssIGRheXM6IDE0LCBkYXlVbml0OiA3IH0sXG4gIHsgbmFtZTogZGF5LCBkYXlzOiAyLCBkYXlVbml0OiAxIH1cbl07XG5cbmV4cG9ydCBjb25zdCB0aW1lRGVsdGFzUmVsYXRpdmUgPSBbXG4gIHsgbmFtZTogdG9tb3Jyb3csIGRheXM6IDEgfSxcbiAgeyBuYW1lOiB5ZXN0ZXJkYXksIGRheXM6IC0xIH0sXG4gIHsgbmFtZTogdG9kYXksIGRheXM6IDAgfVxuXTtcblxuQFBpcGUoe1xuICBuYW1lOiAnbHV4UmVsYXRpdmVUaW1lc3RhbXAnXG59KVxuZXhwb3J0IGNsYXNzIEx1eFJlbGF0aXZlVGltZXN0YW1wUGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xuICB0cmFuc2Zvcm0odGltZXN0YW1wOiBudW1iZXIsIGRlZmF1bHRUZXh0OiBzdHJpbmcgPSAnJywgcHJlZml4Pzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIXRpbWVzdGFtcCkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRUZXh0O1xuICAgIH1cblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgdGhlbiA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7XG5cbiAgICBjb25zdCBkZWx0YSA9IHRoaXMuY2FsY0RpZmYobm93LCB0aGVuKTtcbiAgICBsZXQgdGltZU5hbWUgPSBudWxsO1xuXG4gICAgZm9yIChjb25zdCB0aW1lRGVsdGEgb2YgdGltZURlbHRhcykge1xuICAgICAgY29uc3QgdGVtcERlbHRhID0gZGVsdGEgPCAwID8gZGVsdGEgKiAtMSA6IGRlbHRhO1xuXG4gICAgICBpZiAodGVtcERlbHRhID49IHRpbWVEZWx0YS5kYXlzKSB7XG4gICAgICAgIGlmICghcHJlZml4KSB7XG4gICAgICAgICAgcHJlZml4ID0gZGVsdGEgPCAwID8gcHJlZml4UGFzdCA6IHByZWZpeEZ1dHVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0aW1lVW5pdHMgPSB0aW1lRGVsdGEubmFtZSA9PT0gZGF5ID8gdGVtcERlbHRhIDogTWF0aC5mbG9vcih0ZW1wRGVsdGEgLyB0aW1lRGVsdGEuZGF5VW5pdCk7XG4gICAgICAgIHRpbWVVbml0cyAqPSB0aW1lVW5pdHMgPCAwID8gLTEgOiAxO1xuICAgICAgICB0aW1lTmFtZSA9IGAke3ByZWZpeH0gJHt0aW1lVW5pdHN9ICR7dGltZURlbHRhLm5hbWV9YDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRpbWVOYW1lID09PSBudWxsKSB7XG4gICAgICBmb3IgKGNvbnN0IHRpbWVEZWx0YSBvZiB0aW1lRGVsdGFzUmVsYXRpdmUpIHtcbiAgICAgICAgaWYgKGRlbHRhID09PSB0aW1lRGVsdGEuZGF5cykge1xuICAgICAgICAgIHRpbWVOYW1lID0gdGltZURlbHRhLm5hbWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRpbWVOYW1lO1xuICB9XG5cbiAgcHJpdmF0ZSBjYWxjRGlmZihhLCBiKSB7XG4gICAgY29uc3QgdXRjMSA9IERhdGUuVVRDKGEuZ2V0RnVsbFllYXIoKSwgYS5nZXRNb250aCgpLCBhLmdldERhdGUoKSk7XG4gICAgY29uc3QgdXRjMiA9IERhdGUuVVRDKGIuZ2V0RnVsbFllYXIoKSwgYi5nZXRNb250aCgpLCBiLmdldERhdGUoKSk7XG5cbiAgICByZXR1cm4gTWF0aC5mbG9vcigodXRjMiAtIHV0YzEpIC8gTVNfUEVSX0RBWSk7XG4gIH1cbn1cbiJdfQ==
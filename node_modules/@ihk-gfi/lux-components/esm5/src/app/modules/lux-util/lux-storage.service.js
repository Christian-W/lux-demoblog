import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
/**
 * Der LuxStorageService speichert Daten im lokalen Browserstorage.
 * Wenn man beim Speichern (Methode -> setItem) angibt, dass es sich um sensible Daten handelt,
 * können diese einfach über die Methode 'clearSensitiveItems' gelöscht werden.
 */
var LuxStorageService = /** @class */ (function () {
    function LuxStorageService() {
        var _this = this;
        this.postfixSensitive = '.sensitive';
        this.itemSources = new Map();
        addEventListener('storage', function (event) {
            if (event.key) {
                if (_this.itemSources.has(event.key)) {
                    _this.itemSources.get(event.key).next(event.newValue);
                }
            }
        });
    }
    /**
     * Diese Methode liefert den Wert für den übergebenen Schlüssel zurück.
     *
     * @param key - Der eindeutige Schlüssel.
     * @returns Liefert den Wert für den übergebenen Schlüssel zurück.
     */
    LuxStorageService.prototype.getItem = function (key) {
        if (!this.itemSources.has(key)) {
            this.itemSources.set(key, new BehaviorSubject(localStorage.getItem(key)));
        }
        return this.itemSources.get(key).getValue();
    };
    /**
     * Diese Methode liefert ein Observable zurück, das über alle Änderungen an dem Schlüssel informiert wird.
     *
     * @param key - Der eindeutige Schlüssel.
     * @returns Liefert ein Observable zurück, das über alle Änderungen an dem Schlüssel informiert wird.
     */
    LuxStorageService.prototype.getItemAsObservable = function (key) {
        if (!this.itemSources.has(key)) {
            this.itemSources.set(key, new BehaviorSubject(localStorage.getItem(key)));
        }
        return this.itemSources.get(key).asObservable();
    };
    /**
     * Diese Methode setzt den übergebenen Wert für den Schlüssel. Zusätzlich muss angegeben werden, ob es sich um
     * sensible oder personenbezogene Daten handelt.
     *
     * @param key - Der eindeutige Schlüssel.
     * @param value - Der neue Wert.
     * @param sensitive - Gibt an, ob es sich um sensible oder personenbezogene Daten handelt. Diese können leicht über
     *                    die Methode 'clearSensitiveItems' (z.B. beim Ausloggen) gelöscht werden.
     */
    LuxStorageService.prototype.setItem = function (key, value, sensitive) {
        try {
            localStorage.setItem(key, value);
            if (sensitive) {
                localStorage.setItem(key + this.postfixSensitive, 'true');
            }
            if (this.itemSources.has(key)) {
                this.itemSources.get(key).next(localStorage.getItem(key));
            }
        }
        catch (error) {
            this.itemSources.get(key).error(error);
        }
    };
    /**
     * Diese Methode entfernt den übergebenen Schlüssel.
     *
     * @param key - Der eindeutige Schlüssel.
     */
    LuxStorageService.prototype.removeItem = function (key) {
        localStorage.removeItem(key);
        localStorage.removeItem(key + this.postfixSensitive);
        if (this.itemSources.has(key)) {
            this.itemSources.get(key).next(localStorage.getItem(key));
        }
    };
    /**
     * Diese Methode löscht alle sensiblen und personenbezogenen Einträge (d.h. alle Items bei denen das Flag 'sensitive'
     * auf true gesetzt wurde).
     */
    LuxStorageService.prototype.clearSensitiveItems = function () {
        var _this = this;
        // Alle Schlüssel sammeln.
        var keys = [];
        for (var i = 0; i < localStorage.length; i++) {
            keys.push(localStorage.key(i));
        }
        // Alle sensiblen Einträge löschen.
        keys.forEach(function (key) {
            if (key && key.endsWith(_this.postfixSensitive)) {
                _this.removeItem(key.replace(_this.postfixSensitive, ''));
            }
        });
    };
    /**
     * Diese Methode löscht alle Einträge aus dem Storage.
     */
    LuxStorageService.prototype.clearAll = function () {
        localStorage.clear();
        this.itemSources.forEach(function (itemSource) {
            itemSource.next(null);
            itemSource.complete();
        });
        this.itemSources.clear();
    };
    LuxStorageService = tslib_1.__decorate([
        Injectable(),
        tslib_1.__metadata("design:paramtypes", [])
    ], LuxStorageService);
    return LuxStorageService;
}());
export { LuxStorageService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LXN0b3JhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BpaGstZ2ZpL2x1eC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9tb2R1bGVzL2x1eC11dGlsL2x1eC1zdG9yYWdlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUVuRDs7OztHQUlHO0FBRUg7SUFLRTtRQUFBLGlCQVFDO1FBWmdCLHFCQUFnQixHQUFHLFlBQVksQ0FBQztRQUV6QyxnQkFBVyxHQUF5QyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBR3BFLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxVQUFDLEtBQW1CO1lBQzlDLElBQUksS0FBSyxDQUFDLEdBQUcsRUFBRTtnQkFDYixJQUFJLEtBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRTtvQkFDbkMsS0FBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7aUJBQ3REO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILG1DQUFPLEdBQVAsVUFBUSxHQUFXO1FBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUM5QixJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsSUFBSSxlQUFlLENBQVMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkY7UUFFRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFD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eEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzNCLENBQUM7SUEvR1UsaUJBQWlCO1FBRDdCLFVBQVUsRUFBRTs7T0FDQSxpQkFBaUIsQ0FnSDdCO0lBQUQsd0JBQUM7Q0FBQSxBQWhIRCxJQWdIQztTQWhIWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcblxuLyoqXG4gKiBEZXIgTHV4U3RvcmFnZVNlcnZpY2Ugc3BlaWNoZXJ0IERhdGVuIGltIGxva2FsZW4gQnJvd3NlcnN0b3JhZ2UuXG4gKiBXZW5uIG1hbiBiZWltIFNwZWljaGVybiAoTWV0aG9kZSAtPiBzZXRJdGVtKSBhbmdpYnQsIGRhc3MgZXMgc2ljaCB1bSBzZW5zaWJsZSBEYXRlbiBoYW5kZWx0LFxuICoga8O2bm5lbiBkaWVzZSBlaW5mYWNoIMO8YmVyIGRpZSBNZXRob2RlICdjbGVhclNlbnNpdGl2ZUl0ZW1zJyBnZWzDtnNjaHQgd2VyZGVuLlxuICovXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTHV4U3RvcmFnZVNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IHBvc3RmaXhTZW5zaXRpdmUgPSAnLnNlbnNpdGl2ZSc7XG5cbiAgcHJpdmF0ZSBpdGVtU291cmNlczogTWFwPHN0cmluZywgQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCAoZXZlbnQ6IFN0b3JhZ2VFdmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LmtleSkge1xuICAgICAgICBpZiAodGhpcy5pdGVtU291cmNlcy5oYXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgIHRoaXMuaXRlbVNvdXJjZXMuZ2V0KGV2ZW50LmtleSkubmV4dChldmVudC5uZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEaWVzZSBNZXRob2RlIGxpZWZlcnQgZGVuIFdlcnQgZsO8ciBkZW4gw7xiZXJnZWJlbmVuIFNjaGzDvHNzZWwgenVyw7xjay5cbiAgICpcbiAgICogQHBhcmFtIGtleSAtIERlciBlaW5kZXV0aWdlIFNjaGzDvHNzZWwuXG4gICAqIEByZXR1cm5zIExpZWZlcnQgZGVuIFdlcnQgZsO8ciBkZW4gw7xiZXJnZWJlbmVuIFNjaGzDvHNzZWwgenVyw7xjay5cbiAgICovXG4gIGdldEl0ZW0oa2V5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmICghdGhpcy5pdGVtU291cmNlcy5oYXMoa2V5KSkge1xuICAgICAgdGhpcy5pdGVtU291cmNlcy5zZXQoa2V5LCBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4obG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSkpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLml0ZW1Tb3VyY2VzLmdldChrZXkpLmdldFZhbHVlKCk7XG4gIH1cblxuICAvKipcbiAgICogRGllc2UgTWV0aG9kZSBsaWVmZXJ0IGVpbiBPYnNlcnZhYmxlIHp1csO8Y2ssIGRhcyDDvGJlciBhbGxlIMOEbmRlcnVuZ2VuIGFuIGRlbSBTY2hsw7xzc2VsIGluZm9ybWllcnQgd2lyZC5cbiAgICpcbiAgICogQHBhcmFtIGtleSAtIERlciBlaW5kZXV0aWdlIFNjaGzDvHNzZWwuXG4gICAqIEByZXR1cm5zIExpZWZlcnQgZWluIE9ic2VydmFibGUgenVyw7xjaywgZGFzIMO8YmVyIGFsbGUgw4RuZGVydW5nZW4gYW4gZGVtIFNjaGzDvHNzZWwgaW5mb3JtaWVydCB3aXJkLlxuICAgKi9cbiAgZ2V0SXRlbUFzT2JzZXJ2YWJsZShrZXk6IHN0cmluZyk6IE9ic2VydmFibGU8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLml0ZW1Tb3VyY2VzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLml0ZW1Tb3VyY2VzLnNldChrZXksIG5ldyBCZWhhdmlvclN1YmplY3Q8c3RyaW5nPihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaXRlbVNvdXJjZXMuZ2V0KGtleSkuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICAvKipcbiAgICogRGllc2UgTWV0aG9kZSBzZXR6dCBkZW4gw7xiZXJnZWJlbmVuIFdlcnQgZsO8ciBkZW4gU2NobMO8c3NlbC4gWnVzw6R0emxpY2ggbXVzcyBhbmdlZ2ViZW4gd2VyZGVuLCBvYiBlcyBzaWNoIHVtXG4gICAqIHNlbnNpYmxlIG9kZXIgcGVyc29uZW5iZXpvZ2VuZSBEYXRlbiBoYW5kZWx0LlxuICAgKlxuICAgKiBAcGFyYW0ga2V5IC0gRGVyIGVpbmRldXRpZ2UgU2NobMO8c3NlbC5cbiAgICogQHBhcmFtIHZhbHVlIC0gRGVyIG5ldWUgV2VydC5cbiAgICogQHBhcmFtIHNlbnNpdGl2ZSAtIEdpYnQgYW4sIG9iIGVzIHNpY2ggdW0gc2Vuc2libGUgb2RlciBwZXJzb25lbmJlem9nZW5lIERhdGVuIGhhbmRlbHQuIERpZXNlIGvDtm5uZW4gbGVpY2h0IMO8YmVyXG4gICAqICAgICAgICAgICAgICAgICAgICBkaWUgTWV0aG9kZSAnY2xlYXJTZW5zaXRpdmVJdGVtcycgKHouQi4gYmVpbSBBdXNsb2dnZW4pIGdlbMO2c2NodCB3ZXJkZW4uXG4gICAqL1xuICBzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBzZW5zaXRpdmU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XG5cbiAgICAgIGlmIChzZW5zaXRpdmUpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5ICsgdGhpcy5wb3N0Zml4U2Vuc2l0aXZlLCAndHJ1ZScpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXRlbVNvdXJjZXMuaGFzKGtleSkpIHtcbiAgICAgICAgdGhpcy5pdGVtU291cmNlcy5nZXQoa2V5KS5uZXh0KGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLml0ZW1Tb3VyY2VzLmdldChrZXkpLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGllc2UgTWV0aG9kZSBlbnRmZXJudCBkZW4gw7xiZXJnZWJlbmVuIFNjaGzDvHNzZWwuXG4gICAqXG4gICAqIEBwYXJhbSBrZXkgLSBEZXIgZWluZGV1dGlnZSBTY2hsw7xzc2VsLlxuICAgKi9cbiAgcmVtb3ZlSXRlbShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5ICsgdGhpcy5wb3N0Zml4U2Vuc2l0aXZlKTtcblxuICAgIGlmICh0aGlzLml0ZW1Tb3VyY2VzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLml0ZW1Tb3VyY2VzLmdldChrZXkpLm5leHQobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERpZXNlIE1ldGhvZGUgbMO2c2NodCBhbGxlIHNlbnNpYmxlbiB1bmQgcGVyc29uZW5iZXpvZ2VuZW4gRWludHLDpGdlIChkLmguIGFsbGUgSXRlbXMgYmVpIGRlbmVuIGRhcyBGbGFnICdzZW5zaXRpdmUnXG4gICAqIGF1ZiB0cnVlIGdlc2V0enQgd3VyZGUpLlxuICAgKi9cbiAgY2xlYXJTZW5zaXRpdmVJdGVtcygpOiB2b2lkIHtcbiAgICAvLyBBbGxlIFNjaGzDvHNzZWwgc2FtbWVsbi5cbiAgICBjb25zdCBrZXlzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBrZXlzLnB1c2gobG9jYWxTdG9yYWdlLmtleShpKSk7XG4gICAgfVxuXG4gICAgLy8gQWxsZSBzZW5zaWJsZW4gRWludHLDpGdlIGzDtnNjaGVuLlxuICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKGtleSAmJiBrZXkuZW5kc1dpdGgodGhpcy5wb3N0Zml4U2Vuc2l0aXZlKSkge1xuICAgICAgICB0aGlzLnJlbW92ZUl0ZW0oa2V5LnJlcGxhY2UodGhpcy5wb3N0Zml4U2Vuc2l0aXZlLCAnJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERpZXNlIE1ldGhvZGUgbMO2c2NodCBhbGxlIEVpbnRyw6RnZSBhdXMgZGVtIFN0b3JhZ2UuXG4gICAqL1xuICBjbGVhckFsbCgpOiB2b2lkIHtcbiAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgICB0aGlzLml0ZW1Tb3VyY2VzLmZvckVhY2goKGl0ZW1Tb3VyY2U6IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KSA9PiB7XG4gICAgICBpdGVtU291cmNlLm5leHQobnVsbCk7XG4gICAgICBpdGVtU291cmNlLmNvbXBsZXRlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLml0ZW1Tb3VyY2VzLmNsZWFyKCk7XG4gIH1cbn1cbiJdfQ==
import * as tslib_1 from "tslib";
import { FormGroup } from '@angular/forms';
import { LuxBackgroundColorsEnum, LuxFontColorsEnum } from './lux-colors.enum';
var LuxUtil = /** @class */ (function () {
    function LuxUtil() {
    }
    /**
     * Prueft ob ein String leer ist.
     * @param str
     * @returns boolean
     */
    LuxUtil.isEmpty = function (str) {
        return !str || 0 === str.length;
    };
    /**
     * Liest aus einem Objekt ein bestimmtes Feld aus.
     * Laesst sich auch ueber mehrere Unterobjekte verschachteln.
     * Beispiele fuer propertyNamePath:
     * "value"
     * "unterobjekt1.unterobjekt2.value"
     *
     * @param el
     * @param propertyNamePath
     * @returns any
     */
    LuxUtil.readPropertyValueFromObject = function (el, propertyNamePath) {
        var e_1, _a;
        var result = null;
        if (el && propertyNamePath) {
            var splitProperties = propertyNamePath.split('.');
            if (splitProperties.length > 0) {
                var tempObject = el;
                try {
                    for (var splitProperties_1 = tslib_1.__values(splitProperties), splitProperties_1_1 = splitProperties_1.next(); !splitProperties_1_1.done; splitProperties_1_1 = splitProperties_1.next()) {
                        var property = splitProperties_1_1.value;
                        tempObject = tempObject[property];
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (splitProperties_1_1 && !splitProperties_1_1.done && (_a = splitProperties_1.return)) _a.call(splitProperties_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                result = tempObject;
            }
            else {
                result = el[propertyNamePath];
            }
        }
        return result;
    };
    /**
     * Gibt eine von verschiedenen vordefinierten Fehlernachrichten passend zu den
     * vorhandenen Fehlern der uebergebenen FormControl zurueck.
     * @param formControl
     * @returns string
     */
    LuxUtil.getErrorMessage = function (formControl) {
        if (formControl) {
            if (formControl.hasError('required')) {
                return 'Dieses Feld darf nicht leer sein';
            }
            if (formControl.hasError('minlength')) {
                return 'Die Mindestlänge ist ' + formControl.getError('minlength').requiredLength;
            }
            if (formControl.hasError('maxlength')) {
                return 'Die Maximallänge ist ' + formControl.getError('maxlength').requiredLength;
            }
            if (formControl.hasError('email')) {
                return 'Dies ist keine gültige E-Mailadresse';
            }
            if (formControl.hasError('min')) {
                return 'Der Minimalwert ist ' + formControl.getError('min').min;
            }
            if (formControl.hasError('max')) {
                return 'Der Maximalwert ist ' + formControl.getError('max').max;
            }
            if (formControl.hasError('pattern')) {
                var pattern = formControl.getError('pattern').requiredPattern;
                return 'Entspricht nicht dem Muster "' + pattern.substring(1, pattern.length - 1) + '"';
            }
        }
        return '';
    };
    /**
     * Prueft ob der uebergebene Wert ein JS-Datum ist.
     * @param value
     * @returns boolean
     */
    LuxUtil.isDate = function (value) {
        return value instanceof Date && !isNaN(value.valueOf());
    };
    /**
     * Zeigt die Validierungsfehler der einzelnen FormControls innerhalb der FormGroup an.
     * Wenn innerhalb der übergebenen FormGroup weitere Formgroups enthalten sind, werden
     * diese ebenfalls validiert.
     * @param formGroup
     */
    LuxUtil.showValidationErrors = function (formGroup) {
        var _this = this;
        Object.keys(formGroup.controls).forEach(function (field) {
            var control = formGroup.get(field);
            if (control instanceof FormGroup) {
                _this.showValidationErrors(control);
            }
            else {
                control.markAsTouched({ onlySelf: true });
            }
        });
    };
    /**
     * Diese Methode scrollt zu der übergebenen Id.
     *
     * @param id Eine Elementid (z.B. <tag id="myId">...)
     */
    LuxUtil.goTo = function (id) {
        var element = document.querySelector('#' + id);
        if (element) {
            setTimeout(function () {
                element.scrollIntoView();
            });
        }
    };
    /**
     * Prueft ob die Applikation im IE geoeffnet ist.
     * @returns boolean
     */
    LuxUtil.isIE = function () {
        var msie = window.document['documentMode'];
        return msie && msie <= 11;
    };
    /**
     * Prueft ob die Applikation im Edge geoeffnet ist.
     * @returns boolean
     */
    LuxUtil.isEdge = function () {
        return window.navigator.userAgent.indexOf('Edge') > -1;
    };
    /**
     * Prueft ob die Applikation im IE oder Edge geoffnet ist.
     * @returns boolean
     */
    LuxUtil.isIEorEdge = function () {
        return LuxUtil.isIE() || LuxUtil.isEdge();
    };
    /**
     * Diese Methode verhindert, dass ein Event weiterverarbeitet wird.
     *
     * @param event Ein beliebiges Event.
     */
    LuxUtil.stopEventPropagation = function (event) {
        if (event) {
            if (event.stopPropagation) {
                event.stopPropagation();
            }
            else {
                console.log('Die Funktion "event.stopPropagation()" wird nicht unterstützt.');
            }
        }
    };
    LuxUtil.getColorsByBgColorsEnum = function (color) {
        var result = { backgroundCSSClass: 'lux-bg-color-blue', fontCSSClass: 'lux-font-color-white' };
        if (LuxBackgroundColorsEnum[color]) {
            result.backgroundCSSClass = 'lux-bg-color-' + color;
            switch (color) {
                case LuxBackgroundColorsEnum.gray:
                case LuxBackgroundColorsEnum.orange:
                case LuxBackgroundColorsEnum.yellow:
                    result.fontCSSClass = 'lux-font-color-' + LuxFontColorsEnum.black;
                    break;
                default:
                    result.fontCSSClass = 'lux-font-color-' + LuxFontColorsEnum.white;
                    break;
            }
        }
        return result;
    };
    LuxUtil.isNumber = function (toCheck) {
        return !Number.isNaN(+toCheck);
    };
    LuxUtil.base64ToArrayBuffer = function (data) {
        var binaryString = window.atob(data);
        var bytes = new Uint8Array(binaryString.length);
        for (var i = 0; i < binaryString.length; i++) {
            bytes[i] = binaryString.charCodeAt(i);
        }
        return bytes;
    };
    LuxUtil.ISO_8601_FULL = new RegExp('^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$', 'i');
    return LuxUtil;
}());
export { LuxUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LXV0aWwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWhrLWdmaS9sdXgtY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kdWxlcy9sdXgtdXRpbC9sdXgtdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFlLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRS9FO0lBQUE7SUFtTUEsQ0FBQztJQTdMQzs7OztPQUlHO0lBQ1csZUFBTyxHQUFyQixVQUFzQixHQUFHO1FBQ3ZCLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxNQUFNLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7Ozs7Ozs7O09BVUc7SUFDVyxtQ0FBMkIsR0FBekMsVUFBMEMsRUFBTyxFQUFFLGdCQUF3Qjs7UUFDekUsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLElBQUksRUFBRSxJQUFJLGdCQUFnQixFQUFFO1lBQzFCLElBQU0sZUFBZSxHQUFHLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUVwRCxJQUFJLGVBQWUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dCQUM5QixJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUM7O29CQUVwQixLQUF1QixJQUFBLG9CQUFBLGlCQUFBLGVBQWUsQ0FBQSxnREFBQSw2RUFBRTt3QkFBbkMsSUFBTSxRQUFRLDRCQUFBO3dCQUNqQixVQUFVLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3FCQUNuQzs7Ozs7Ozs7O2dCQUNELE1BQU0sR0FBRyxVQUFVLENBQUM7YUFDckI7aUJBQU07Z0JBQ0wsTUFBTSxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2FBQy9CO1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQ7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SUFFYSxnQkFBUSxHQUF0QixVQUF1QixPQUFZO1FBQ2pDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVhLDJCQUFtQixHQUFqQyxVQUFrQyxJQUFJO1FBQ3BDLElBQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkMsSUFBTSxLQUFLLEdBQUcsSUFBSSxVQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2xELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzVDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3ZDO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBak1zQixxQkFBYSxHQUFHLElBQUksTUFBTSxDQUMvQywrRUFBK0UsRUFDL0UsR0FBRyxDQUNKLENBQUM7SUErTEosY0FBQztDQUFBLEFBbk1ELElBbU1DO1NBbk1ZLE9BQU8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGb3JtQ29udHJvbCwgRm9ybUdyb3VwIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTHV4QmFja2dyb3VuZENvbG9yc0VudW0sIEx1eEZvbnRDb2xvcnNFbnVtIH0gZnJvbSAnLi9sdXgtY29sb3JzLmVudW0nO1xuXG5leHBvcnQgY2xhc3MgTHV4VXRpbCB7XG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgSVNPXzg2MDFfRlVMTCA9IG5ldyBSZWdFeHAoXG4gICAgJ15cXFxcZHs0fS1cXFxcZFxcXFxkLVxcXFxkXFxcXGRUXFxcXGRcXFxcZDpcXFxcZFxcXFxkOlxcXFxkXFxcXGQoXFxcXC5cXFxcZCspPygoWystXVxcXFxkXFxcXGQ6XFxcXGRcXFxcZCl8Wik/JCcsXG4gICAgJ2knXG4gICk7XG5cbiAgLyoqXG4gICAqIFBydWVmdCBvYiBlaW4gU3RyaW5nIGxlZXIgaXN0LlxuICAgKiBAcGFyYW0gc3RyXG4gICAqIEByZXR1cm5zIGJvb2xlYW5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaXNFbXB0eShzdHIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIXN0ciB8fCAwID09PSBzdHIubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIExpZXN0IGF1cyBlaW5lbSBPYmpla3QgZWluIGJlc3RpbW10ZXMgRmVsZCBhdXMuXG4gICAqIExhZXNzdCBzaWNoIGF1Y2ggdWViZXIgbWVocmVyZSBVbnRlcm9iamVrdGUgdmVyc2NoYWNodGVsbi5cbiAgICogQmVpc3BpZWxlIGZ1ZXIgcHJvcGVydHlOYW1lUGF0aDpcbiAgICogXCJ2YWx1ZVwiXG4gICAqIFwidW50ZXJvYmpla3QxLnVudGVyb2JqZWt0Mi52YWx1ZVwiXG4gICAqXG4gICAqIEBwYXJhbSBlbFxuICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lUGF0aFxuICAgKiBAcmV0dXJucyBhbnlcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcmVhZFByb3BlcnR5VmFsdWVGcm9tT2JqZWN0KGVsOiBhbnksIHByb3BlcnR5TmFtZVBhdGg6IHN0cmluZyk6IGFueSB7XG4gICAgbGV0IHJlc3VsdCA9IG51bGw7XG4gICAgaWYgKGVsICYmIHByb3BlcnR5TmFtZVBhdGgpIHtcbiAgICAgIGNvbnN0IHNwbGl0UHJvcGVydGllcyA9IHByb3BlcnR5TmFtZVBhdGguc3BsaXQoJy4nKTtcblxuICAgICAgaWYgKHNwbGl0UHJvcGVydGllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGxldCB0ZW1wT2JqZWN0ID0gZWw7XG5cbiAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBzcGxpdFByb3BlcnRpZXMpIHtcbiAgICAgICAgICB0ZW1wT2JqZWN0ID0gdGVtcE9iamVjdFtwcm9wZXJ0eV07XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gdGVtcE9iamVjdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IGVsW3Byb3BlcnR5TmFtZVBhdGhdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdpYnQgZWluZSB2b24gdmVyc2NoaWVkZW5lbiB2b3JkZWZpbmllcnRlbiBGZWhsZXJuYWNocmljaHRlbiBwYXNzZW5kIHp1IGRlblxuICAgKiB2b3JoYW5kZW5lbiBGZWhsZXJuIGRlciB1ZWJlcmdlYmVuZW4gRm9ybUNvbnRyb2wgenVydWVjay5cbiAgICogQHBhcmFtIGZvcm1Db250cm9sXG4gICAqIEByZXR1cm5zIHN0cmluZ1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRFcnJvck1lc3NhZ2UoZm9ybUNvbnRyb2w6IEZvcm1Db250cm9sKTogc3RyaW5nIHtcbiAgICBpZiAoZm9ybUNvbnRyb2wpIHtcbiAgICAgIGlmIChmb3JtQ29udHJvbC5oYXNFcnJvcigncmVxdWlyZWQnKSkge1xuICAgICAgICByZXR1cm4gJ0RpZXNlcyBGZWxkIGRhcmYgbmljaHQgbGVlciBzZWluJztcbiAgICAgIH1cblxuICAgICAgaWYgKGZvcm1Db250cm9sLmhhc0Vycm9yKCdtaW5sZW5ndGgnKSkge1xuICAgICAgICByZXR1cm4gJ0RpZSBNaW5kZXN0bMOkbmdlIGlzdCAnICsgZm9ybUNvbnRyb2wuZ2V0RXJyb3IoJ21pbmxlbmd0aCcpLnJlcXVpcmVkTGVuZ3RoO1xuICAgICAgfVxuXG4gICAgICBpZiAoZm9ybUNvbnRyb2wuaGFzRXJyb3IoJ21heGxlbmd0aCcpKSB7XG4gICAgICAgIHJldHVybiAnRGllIE1heGltYWxsw6RuZ2UgaXN0ICcgKyBmb3JtQ29udHJvbC5nZXRFcnJvcignbWF4bGVuZ3RoJykucmVxdWlyZWRMZW5ndGg7XG4gICAgICB9XG5cbiAgICAgIGlmIChmb3JtQ29udHJvbC5oYXNFcnJvcignZW1haWwnKSkge1xuICAgICAgICByZXR1cm4gJ0RpZXMgaXN0IGtlaW5lIGfDvGx0aWdlIEUtTWFpbGFkcmVzc2UnO1xuICAgICAgfVxuXG4gICAgICBpZiAoZm9ybUNvbnRyb2wuaGFzRXJyb3IoJ21pbicpKSB7XG4gICAgICAgIHJldHVybiAnRGVyIE1pbmltYWx3ZXJ0IGlzdCAnICsgZm9ybUNvbnRyb2wuZ2V0RXJyb3IoJ21pbicpLm1pbjtcbiAgICAgIH1cblxuICAgICAgaWYgKGZvcm1Db250cm9sLmhhc0Vycm9yKCdtYXgnKSkge1xuICAgICAgICByZXR1cm4gJ0RlciBNYXhpbWFsd2VydCBpc3QgJyArIGZvcm1Db250cm9sLmdldEVycm9yKCdtYXgnKS5tYXg7XG4gICAgICB9XG5cbiAgICAgIGlmIChmb3JtQ29udHJvbC5oYXNFcnJvcigncGF0dGVybicpKSB7XG4gICAgICAgIGNvbnN0IHBhdHRlcm4gPSBmb3JtQ29udHJvbC5nZXRFcnJvcigncGF0dGVybicpLnJlcXVpcmVkUGF0dGVybjtcbiAgICAgICAgcmV0dXJuICdFbnRzcHJpY2h0IG5pY2h0IGRlbSBNdXN0ZXIgXCInICsgcGF0dGVybi5zdWJzdHJpbmcoMSwgcGF0dGVybi5sZW5ndGggLSAxKSArICdcIic7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiBQcnVlZnQgb2IgZGVyIHVlYmVyZ2ViZW5lIFdlcnQgZWluIEpTLURhdHVtIGlzdC5cbiAgICogQHBhcmFtIHZhbHVlXG4gICAqIEByZXR1cm5zIGJvb2xlYW5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaXNEYXRlKHZhbHVlOiBhbnkpIHtcbiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTih2YWx1ZS52YWx1ZU9mKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFplaWd0IGRpZSBWYWxpZGllcnVuZ3NmZWhsZXIgZGVyIGVpbnplbG5lbiBGb3JtQ29udHJvbHMgaW5uZXJoYWxiIGRlciBGb3JtR3JvdXAgYW4uXG4gICAqIFdlbm4gaW5uZXJoYWxiIGRlciDDvGJlcmdlYmVuZW4gRm9ybUdyb3VwIHdlaXRlcmUgRm9ybWdyb3VwcyBlbnRoYWx0ZW4gc2luZCwgd2VyZGVuXG4gICAqIGRpZXNlIGViZW5mYWxscyB2YWxpZGllcnQuXG4gICAqIEBwYXJhbSBmb3JtR3JvdXBcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2hvd1ZhbGlkYXRpb25FcnJvcnMoZm9ybUdyb3VwOiBGb3JtR3JvdXApIHtcbiAgICBPYmplY3Qua2V5cyhmb3JtR3JvdXAuY29udHJvbHMpLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgY29uc3QgY29udHJvbCA9IGZvcm1Hcm91cC5nZXQoZmllbGQpO1xuICAgICAgaWYgKGNvbnRyb2wgaW5zdGFuY2VvZiBGb3JtR3JvdXApIHtcbiAgICAgICAgdGhpcy5zaG93VmFsaWRhdGlvbkVycm9ycyhjb250cm9sKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRyb2wubWFya0FzVG91Y2hlZCh7IG9ubHlTZWxmOiB0cnVlIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERpZXNlIE1ldGhvZGUgc2Nyb2xsdCB6dSBkZXIgw7xiZXJnZWJlbmVuIElkLlxuICAgKlxuICAgKiBAcGFyYW0gaWQgRWluZSBFbGVtZW50aWQgKHouQi4gPHRhZyBpZD1cIm15SWRcIj4uLi4pXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdvVG8oaWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGVsZW1lbnQ6IEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGlkKTtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQcnVlZnQgb2IgZGllIEFwcGxpa2F0aW9uIGltIElFIGdlb2VmZm5ldCBpc3QuXG4gICAqIEByZXR1cm5zIGJvb2xlYW5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgaXNJRSgpOiBib29sZWFuIHtcbiAgICBjb25zdCBtc2llID0gd2luZG93LmRvY3VtZW50Wydkb2N1bWVudE1vZGUnXTtcbiAgICByZXR1cm4gbXNpZSAmJiBtc2llIDw9IDExO1xuICB9XG5cbiAgLyoqXG4gICAqIFBydWVmdCBvYiBkaWUgQXBwbGlrYXRpb24gaW0gRWRnZSBnZW9lZmZuZXQgaXN0LlxuICAgKiBAcmV0dXJucyBib29sZWFuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGlzRWRnZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignRWRnZScpID4gLTE7XG4gIH1cblxuICAvKipcbiAgICogUHJ1ZWZ0IG9iIGRpZSBBcHBsaWthdGlvbiBpbSBJRSBvZGVyIEVkZ2UgZ2VvZmZuZXQgaXN0LlxuICAgKiBAcmV0dXJucyBib29sZWFuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGlzSUVvckVkZ2UoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIEx1eFV0aWwuaXNJRSgpIHx8IEx1eFV0aWwuaXNFZGdlKCk7XG4gIH1cblxuICAvKipcbiAgICogRGllc2UgTWV0aG9kZSB2ZXJoaW5kZXJ0LCBkYXNzIGVpbiBFdmVudCB3ZWl0ZXJ2ZXJhcmJlaXRldCB3aXJkLlxuICAgKlxuICAgKiBAcGFyYW0gZXZlbnQgRWluIGJlbGllYmlnZXMgRXZlbnQuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHN0b3BFdmVudFByb3BhZ2F0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0RpZSBGdW5rdGlvbiBcImV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXCIgd2lyZCBuaWNodCB1bnRlcnN0w7x0enQuJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRDb2xvcnNCeUJnQ29sb3JzRW51bShjb2xvcjogTHV4QmFja2dyb3VuZENvbG9yc0VudW0pOiB7IGJhY2tncm91bmRDU1NDbGFzczsgZm9udENTU0NsYXNzIH0ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHsgYmFja2dyb3VuZENTU0NsYXNzOiAnbHV4LWJnLWNvbG9yLWJsdWUnLCBmb250Q1NTQ2xhc3M6ICdsdXgtZm9udC1jb2xvci13aGl0ZScgfTtcbiAgICBpZiAoTHV4QmFja2dyb3VuZENvbG9yc0VudW1bY29sb3JdKSB7XG4gICAgICByZXN1bHQuYmFja2dyb3VuZENTU0NsYXNzID0gJ2x1eC1iZy1jb2xvci0nICsgY29sb3I7XG4gICAgICBzd2l0Y2ggKGNvbG9yKSB7XG4gICAgICAgIGNhc2UgTHV4QmFja2dyb3VuZENvbG9yc0VudW0uZ3JheTpcbiAgICAgICAgY2FzZSBMdXhCYWNrZ3JvdW5kQ29sb3JzRW51bS5vcmFuZ2U6XG4gICAgICAgIGNhc2UgTHV4QmFja2dyb3VuZENvbG9yc0VudW0ueWVsbG93OlxuICAgICAgICAgIHJlc3VsdC5mb250Q1NTQ2xhc3MgPSAnbHV4LWZvbnQtY29sb3ItJyArIEx1eEZvbnRDb2xvcnNFbnVtLmJsYWNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJlc3VsdC5mb250Q1NTQ2xhc3MgPSAnbHV4LWZvbnQtY29sb3ItJyArIEx1eEZvbnRDb2xvcnNFbnVtLndoaXRlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBpc051bWJlcih0b0NoZWNrOiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIU51bWJlci5pc05hTigrdG9DaGVjayk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGJhc2U2NFRvQXJyYXlCdWZmZXIoZGF0YSkge1xuICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IHdpbmRvdy5hdG9iKGRhdGEpO1xuICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5U3RyaW5nLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnlTdHJpbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ5dGVzW2ldID0gYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQoaSk7XG4gICAgfVxuICAgIHJldHVybiBieXRlcztcbiAgfVxufVxuIl19
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { environment } from '../../../environments/environment';
import { LuxComponentsConfigService } from '../lux-components-config/lux-components-config.service';
import * as i0 from "@angular/core";
import * as i1 from "../lux-components-config/lux-components-config.service";
export var noop = function () { return undefined; };
var LuxConsoleService = /** @class */ (function () {
    function LuxConsoleService(componentsConfigService) {
        // Aus der Konfiguration die Info erhalten, ob Logs angezeigt werden sollen
        componentsConfigService.config.subscribe(function (newConfig) {
            LuxConsoleService_1.config = newConfig;
        });
    }
    LuxConsoleService_1 = LuxConsoleService;
    Object.defineProperty(LuxConsoleService.prototype, "log", {
        /* Nicht-statische Log-Methoden, sie zeigen auch die Quelle des Logs an! */
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.log.bind.call(console.log, console, LuxConsoleService_1.logDate() + ' -');
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LuxConsoleService.prototype, "warn", {
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.warn.bind.call(console.warn, console, LuxConsoleService_1.logDate() + ' -');
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LuxConsoleService.prototype, "error", {
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.error.bind.call(console.error, console, LuxConsoleService_1.logDate() + ' -');
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LuxConsoleService.prototype, "group", {
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.group.bind.call(console.group, console);
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LuxConsoleService.prototype, "info", {
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.info.bind.call(console.info, console);
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LuxConsoleService.prototype, "groupEnd", {
        get: function () {
            if (LuxConsoleService_1.isDebugMode()) {
                return console.groupEnd.bind.call(console.groupEnd, console);
            }
            else {
                return noop;
            }
        },
        enumerable: true,
        configurable: true
    });
    /* Statische Log-Methoden, sie zeigen nicht die Quelle des Logs an! */
    LuxConsoleService.LOG = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.log(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.log(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.log(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    };
    LuxConsoleService.WARN = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.warn(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.warn(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.warn(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    };
    LuxConsoleService.ERROR = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (!LuxConsoleService_1.isDebugMode()) {
            return;
        }
        if (args.length === 1 && args[0] !== null && typeof args[0] === 'object') {
            console.error(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else if (args.length === 1) {
            console.error(LuxConsoleService_1.logDate() + ' -', args[0]);
        }
        else {
            console.error(LuxConsoleService_1.logDate() + ' - ' + this.getLogValue(args));
        }
    };
    LuxConsoleService.logDate = function () {
        var now = new Date();
        var day = LuxConsoleService_1.checkTime(now.getDate());
        var month = LuxConsoleService_1.checkTime(now.getMonth() + 1);
        var year = LuxConsoleService_1.checkTime(now.getFullYear());
        var hours = LuxConsoleService_1.checkTime(now.getHours());
        var minutes = LuxConsoleService_1.checkTime(now.getMinutes());
        var seconds = LuxConsoleService_1.checkTime(now.getSeconds());
        return day + '.' + month + '.' + year + ' ' + hours + ':' + minutes + ':' + seconds;
    };
    LuxConsoleService.getLogValue = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var logValue = [];
        args.forEach(function (arg) {
            if (arg !== null && typeof arg === 'object') {
                arg = JSON.stringify(arg);
            }
            logValue.push(arg);
        });
        return logValue;
    };
    LuxConsoleService.isDebugMode = function () {
        return LuxConsoleService_1.config ? LuxConsoleService_1.config.displayLuxConsoleLogs : environment.production;
    };
    LuxConsoleService.checkTime = function (timeUnit) {
        return timeUnit < 10 ? '0' + timeUnit : timeUnit;
    };
    var LuxConsoleService_1;
    LuxConsoleService.config = {};
    LuxConsoleService.ctorParameters = function () { return [
        { type: LuxComponentsConfigService }
    ]; };
    LuxConsoleService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function LuxConsoleService_Factory() { return new LuxConsoleService(i0.ɵɵinject(i1.LuxComponentsConfigService)); }, token: LuxConsoleService, providedIn: "root" });
    LuxConsoleService = LuxConsoleService_1 = tslib_1.__decorate([
        Injectable({
            providedIn: 'root'
        }),
        tslib_1.__metadata("design:paramtypes", [LuxComponentsConfigService])
    ], LuxConsoleService);
    return LuxConsoleService;
}());
export { LuxConsoleService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LWNvbnNvbGUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BpaGstZ2ZpL2x1eC1jb21wb25lbnRzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9tb2R1bGVzL2x1eC11dGlsL2x1eC1jb25zb2xlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ2hFLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHdEQUF3RCxDQUFDOzs7QUFHcEcsTUFBTSxDQUFDLElBQU0sSUFBSSxHQUFHLGNBQVcsT0FBQSxTQUFTLEVBQVQsQ0FBUyxDQUFDO0FBS3pDO0lBR0UsMkJBQVksdUJBQW1EO1FBQzdELDJFQUEyRTtRQUMzRSx1QkFBdUIsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQUMsU0FBd0M7WUFDaEYsbUJBQWlCLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7MEJBUlUsaUJBQWlCO0lBWTVCLHNCQUFJLGtDQUFHO1FBRlAsMkVBQTJFO2FBRTNFO1lBQ0UsSUFBSSxtQkFBaUIsQ0FBQyxXQUFXLEVBQUUsRUFBRTtnQkFDbkMsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsbUJBQWlCLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7YUFDeEY7aUJBQU07Z0JBQ0wsT0FBTyxJQUFJLENBQUM7YUFDYjtRQUNILENBQUM7OztPQUFBO0lBRUQsc0JBQUksbUNBQUk7YUFBUjtZQUNFLElBQUksbUJBQWlCLENBQUMsV0FBVyxFQUFFLEVBQUU7Z0JBQ25DLE9BQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9B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LEdBQUcsS0FBSyxRQUFRLEVBQUU7Z0JBQzNDLEdBQUcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQzNCO1lBQ0QsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQixDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFYyw2QkFBVyxHQUExQjtRQUNFLE9BQU8sbUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxtQkFBaUIsQ0FBQyxNQUFNLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUM7SUFDNUcsQ0FBQztJQUVjLDJCQUFTLEdBQXhCLFVBQXlCLFFBQWdCO1FBQ3ZDLE9BQU8sUUFBUSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0lBQ25ELENBQUM7O0lBcElNLHdCQUFNLEdBQWtDLEVBQUUsQ0FBQzs7Z0JBRWIsMEJBQTBCOzs7SUFIcEQsaUJBQWlCO1FBSDdCLFVBQVUsQ0FBQztZQUNWLFVBQVUsRUFBRSxNQUFNO1NBQ25CLENBQUM7aURBSXFDLDBCQUEwQjtPQUhwRCxpQkFBaUIsQ0FzSTdCOzRCQWhKRDtDQWdKQyxBQXRJRCxJQXNJQztTQXRJWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gJy4uLy4uLy4uL2Vudmlyb25tZW50cy9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBMdXhDb21wb25lbnRzQ29uZmlnU2VydmljZSB9IGZyb20gJy4uL2x1eC1jb21wb25lbnRzLWNvbmZpZy9sdXgtY29tcG9uZW50cy1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBMdXhDb21wb25lbnRzQ29uZmlnUGFyYW1ldGVycyB9IGZyb20gJy4uL2x1eC1jb21wb25lbnRzLWNvbmZpZy9sdXgtY29tcG9uZW50cy1jb25maWctcGFyYW1ldGVycy5pbnRlcmZhY2UnO1xuXG5leHBvcnQgY29uc3Qgbm9vcCA9ICgpOiBhbnkgPT4gdW5kZWZpbmVkO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBMdXhDb25zb2xlU2VydmljZSB7XG4gIHN0YXRpYyBjb25maWc6IEx1eENvbXBvbmVudHNDb25maWdQYXJhbWV0ZXJzID0ge307XG5cbiAgY29uc3RydWN0b3IoY29tcG9uZW50c0NvbmZpZ1NlcnZpY2U6IEx1eENvbXBvbmVudHNDb25maWdTZXJ2aWNlKSB7XG4gICAgLy8gQXVzIGRlciBLb25maWd1cmF0aW9uIGRpZSBJbmZvIGVyaGFsdGVuLCBvYiBMb2dzIGFuZ2V6ZWlndCB3ZXJkZW4gc29sbGVuXG4gICAgY29tcG9uZW50c0NvbmZpZ1NlcnZpY2UuY29uZmlnLnN1YnNjcmliZSgobmV3Q29uZmlnOiBMdXhDb21wb25lbnRzQ29uZmlnUGFyYW1ldGVycykgPT4ge1xuICAgICAgTHV4Q29uc29sZVNlcnZpY2UuY29uZmlnID0gbmV3Q29uZmlnO1xuICAgIH0pO1xuICB9XG5cbiAgLyogTmljaHQtc3RhdGlzY2hlIExvZy1NZXRob2Rlbiwgc2llIHplaWdlbiBhdWNoIGRpZSBRdWVsbGUgZGVzIExvZ3MgYW4hICovXG5cbiAgZ2V0IGxvZygpIHtcbiAgICBpZiAoTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nLmJpbmQuY2FsbChjb25zb2xlLmxvZywgY29uc29sZSwgTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgfVxuXG4gIGdldCB3YXJuKCkge1xuICAgIGlmIChMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm4gY29uc29sZS53YXJuLmJpbmQuY2FsbChjb25zb2xlLndhcm4sIGNvbnNvbGUsIEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gIH1cblxuICBnZXQgZXJyb3IoKSB7XG4gICAgaWYgKEx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLmVycm9yLmJpbmQuY2FsbChjb25zb2xlLmVycm9yLCBjb25zb2xlLCBMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGdyb3VwKCkge1xuICAgIGlmIChMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm4gY29uc29sZS5ncm91cC5iaW5kLmNhbGwoY29uc29sZS5ncm91cCwgY29uc29sZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgfVxuXG4gIGdldCBpbmZvKCkge1xuICAgIGlmIChMdXhDb25zb2xlU2VydmljZS5pc0RlYnVnTW9kZSgpKSB7XG4gICAgICByZXR1cm4gY29uc29sZS5pbmZvLmJpbmQuY2FsbChjb25zb2xlLmluZm8sIGNvbnNvbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gIH1cblxuICBnZXQgZ3JvdXBFbmQoKSB7XG4gICAgaWYgKEx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLmdyb3VwRW5kLmJpbmQuY2FsbChjb25zb2xlLmdyb3VwRW5kLCBjb25zb2xlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICB9XG5cbiAgLyogU3RhdGlzY2hlIExvZy1NZXRob2Rlbiwgc2llIHplaWdlbiBuaWNodCBkaWUgUXVlbGxlIGRlcyBMb2dzIGFuISAqL1xuXG4gIHN0YXRpYyBMT0coLi4uYXJncykge1xuICAgIGlmICghTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDEgJiYgYXJnc1swXSAhPT0gbnVsbCAmJiB0eXBlb2YgYXJnc1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScsIGFyZ3NbMF0pO1xuICAgIH0gZWxzZSBpZiAoYXJncy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnNvbGUubG9nKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScsIGFyZ3NbMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0gJyArIHRoaXMuZ2V0TG9nVmFsdWUoYXJncykpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBXQVJOKC4uLmFyZ3MpIHtcbiAgICBpZiAoIUx1eENvbnNvbGVTZXJ2aWNlLmlzRGVidWdNb2RlKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIGFyZ3NbMF0gIT09IG51bGwgJiYgdHlwZW9mIGFyZ3NbMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICBjb25zb2xlLndhcm4oTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtJywgYXJnc1swXSk7XG4gICAgfSBlbHNlIGlmIChhcmdzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29uc29sZS53YXJuKEx1eENvbnNvbGVTZXJ2aWNlLmxvZ0RhdGUoKSArICcgLScsIGFyZ3NbMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtICcgKyB0aGlzLmdldExvZ1ZhbHVlKGFyZ3MpKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgRVJST1IoLi4uYXJncykge1xuICAgIGlmICghTHV4Q29uc29sZVNlcnZpY2UuaXNEZWJ1Z01vZGUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDEgJiYgYXJnc1swXSAhPT0gbnVsbCAmJiB0eXBlb2YgYXJnc1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoTHV4Q29uc29sZVNlcnZpY2UubG9nRGF0ZSgpICsgJyAtJywgYXJnc1swXSk7XG4gICAgfSBlbHNlIGlmIChhcmdzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29uc29sZS5lcnJvcihMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0nLCBhcmdzWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcihMdXhDb25zb2xlU2VydmljZS5sb2dEYXRlKCkgKyAnIC0gJyArIHRoaXMuZ2V0TG9nVmFsdWUoYXJncykpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGxvZ0RhdGUoKSB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICAgIGNvbnN0IGRheSA9IEx1eENvbnNvbGVTZXJ2aWNlLmNoZWNrVGltZShub3cuZ2V0RGF0ZSgpKTtcbiAgICBjb25zdCBtb250aCA9IEx1eENvbnNvbGVTZXJ2aWNlLmNoZWNrVGltZShub3cuZ2V0TW9udGgoKSArIDEpO1xuICAgIGNvbnN0IHllYXIgPSBMdXhDb25zb2xlU2VydmljZS5jaGVja1RpbWUobm93LmdldEZ1bGxZZWFyKCkpO1xuICAgIGNvbnN0IGhvdXJzID0gTHV4Q29uc29sZVNlcnZpY2UuY2hlY2tUaW1lKG5vdy5nZXRIb3VycygpKTtcbiAgICBjb25zdCBtaW51dGVzID0gTHV4Q29uc29sZVNlcnZpY2UuY2hlY2tUaW1lKG5vdy5nZXRNaW51dGVzKCkpO1xuICAgIGNvbnN0IHNlY29uZHMgPSBMdXhDb25zb2xlU2VydmljZS5jaGVja1RpbWUobm93LmdldFNlY29uZHMoKSk7XG5cbiAgICByZXR1cm4gZGF5ICsgJy4nICsgbW9udGggKyAnLicgKyB5ZWFyICsgJyAnICsgaG91cnMgKyAnOicgKyBtaW51dGVzICsgJzonICsgc2Vjb25kcztcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldExvZ1ZhbHVlKC4uLmFyZ3MpIHtcbiAgICBjb25zdCBsb2dWYWx1ZSA9IFtdO1xuXG4gICAgYXJncy5mb3JFYWNoKGFyZyA9PiB7XG4gICAgICBpZiAoYXJnICE9PSBudWxsICYmIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGFyZyA9IEpTT04uc3RyaW5naWZ5KGFyZyk7XG4gICAgICB9XG4gICAgICBsb2dWYWx1ZS5wdXNoKGFyZyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbG9nVmFsdWU7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBpc0RlYnVnTW9kZSgpIHtcbiAgICByZXR1cm4gTHV4Q29uc29sZVNlcnZpY2UuY29uZmlnID8gTHV4Q29uc29sZVNlcnZpY2UuY29uZmlnLmRpc3BsYXlMdXhDb25zb2xlTG9ncyA6IGVudmlyb25tZW50LnByb2R1Y3Rpb247XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjaGVja1RpbWUodGltZVVuaXQ6IG51bWJlcikge1xuICAgIHJldHVybiB0aW1lVW5pdCA8IDEwID8gJzAnICsgdGltZVVuaXQgOiB0aW1lVW5pdDtcbiAgfVxufVxuIl19
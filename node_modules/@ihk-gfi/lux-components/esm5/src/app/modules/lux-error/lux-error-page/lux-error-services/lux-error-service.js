import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { Router } from '@angular/router';
import { of } from 'rxjs';
import { LuxErrorPageComponent } from '../lux-error-page.component';
import { LuxErrorStoreService } from './lux-error-store.service';
var LuxErrorService = /** @class */ (function () {
    function LuxErrorService(router, errorStore) {
        this.router = router;
        this.errorStore = errorStore;
        this.errorStore.init();
        this.setConfig(null);
    }
    /**
     * Ueberschreibt die aktuelle Konfiguration fuer die Fehlerseite.
     * Uebernimmt so viele Werte wie moeglich aus der uebergebenen Konfiguration,
     * sonst werden die Default-Werte genutzt.
     * @param luxErrorPageConfig
     */
    LuxErrorService.prototype.setConfig = function (luxErrorPageConfig) {
        this.errorStore.safeNewConfig(luxErrorPageConfig);
        // potentielle alte Route zu LuxErrorPageComponent entfernen
        this.router.config = this.router.config.filter(function (entry) { return entry.component !== LuxErrorPageComponent; });
        // neue Route eintragen
        this.router.config.unshift({ path: this.errorStore.config.errorPageUrl, component: LuxErrorPageComponent });
    };
    /**
     * Navigiert zur Fehlerkomponente und versucht einen Fehler
     * (wenn mitgegeben) zu sichern.
     * @param error
     * @returns Observable<any>
     */
    LuxErrorService.prototype.navigateToErrorPage = function (error) {
        if (error) {
            this.errorStore.error = error;
        }
        var _a = this.errorStore.config, errorPageUrl = _a.errorPageUrl, skipLocationChange = _a.skipLocationChange;
        return of(this.router.navigateByUrl(errorPageUrl, { skipLocationChange: skipLocationChange }));
    };
    LuxErrorService.ctorParameters = function () { return [
        { type: Router },
        { type: LuxErrorStoreService }
    ]; };
    LuxErrorService = tslib_1.__decorate([
        Injectable(),
        tslib_1.__metadata("design:paramtypes", [Router, LuxErrorStoreService])
    ], LuxErrorService);
    return LuxErrorService;
}());
export { LuxErrorService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibHV4LWVycm9yLXNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWhrLWdmaS9sdXgtY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kdWxlcy9sdXgtZXJyb3IvbHV4LWVycm9yLXBhZ2UvbHV4LWVycm9yLXNlcnZpY2VzL2x1eC1lcnJvci1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6QyxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBR3RDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBR2pFO0lBQ0UseUJBQW9CLE1BQWMsRUFBVSxVQUFnQztRQUF4RCxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBc0I7UUFDMUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN2QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILG1DQUFTLEdBQVQsVUFBVSxrQkFBdUM7UUFDL0MsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUNsRCw0REFBNEQ7UUFDNUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQUEsS0FBSyxJQUFJLE9BQUEsS0FBSyxDQUFDLFNBQVMsS0FBSyxxQkFBcUIsRUFBekMsQ0FBeUMsQ0FBQyxDQUFDO1FBQ25HLHVCQUF1QjtRQUN2QixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLFNBQVMsRUFBRSxxQkFBcUIsRUFBRSxDQUFDLENBQUM7SUFDOUcsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsNkNBQW1CLEdBQW5CLFVBQW9CLEtBQWlCO1FBQ25DLElBQUksS0FBSyxFQUFFO1lBQ1QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1NBQy9CO1FBQ0ssSUFBQSwyQkFBNkQsRUFBM0QsOEJBQVksRUFBRSwwQ0FBNkMsQ0FBQztRQUNwRSxPQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsRUFBRSxrQkFBa0Isb0JBQUEsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM3RSxDQUFDOztnQkEvQjJCLE1BQU07Z0JBQXNCLG9CQUFvQjs7SUFEakUsZUFBZTtRQUQzQixVQUFVLEVBQUU7aURBRWlCLE1BQU0sRUFBc0Isb0JBQW9CO09BRGpFLGVBQWUsQ0FpQzNCO0lBQUQsc0JBQUM7Q0FBQSxBQWpDRCxJQWlDQztTQWpDWSxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBJTHV4RXJyb3JQYWdlQ29uZmlnIH0gZnJvbSAnLi4vbHV4LWVycm9yLWludGVyZmFjZXMvbHV4LWVycm9yLXBhZ2UtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBJTHV4RXJyb3IgfSBmcm9tICcuLi9sdXgtZXJyb3ItaW50ZXJmYWNlcy9sdXgtZXJyb3IuaW50ZXJmYWNlJztcbmltcG9ydCB7IEx1eEVycm9yUGFnZUNvbXBvbmVudCB9IGZyb20gJy4uL2x1eC1lcnJvci1wYWdlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBMdXhFcnJvclN0b3JlU2VydmljZSB9IGZyb20gJy4vbHV4LWVycm9yLXN0b3JlLnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTHV4RXJyb3JTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZXI6IFJvdXRlciwgcHJpdmF0ZSBlcnJvclN0b3JlOiBMdXhFcnJvclN0b3JlU2VydmljZSkge1xuICAgIHRoaXMuZXJyb3JTdG9yZS5pbml0KCk7XG4gICAgdGhpcy5zZXRDb25maWcobnVsbCk7XG4gIH1cblxuICAvKipcbiAgICogVWViZXJzY2hyZWlidCBkaWUgYWt0dWVsbGUgS29uZmlndXJhdGlvbiBmdWVyIGRpZSBGZWhsZXJzZWl0ZS5cbiAgICogVWViZXJuaW1tdCBzbyB2aWVsZSBXZXJ0ZSB3aWUgbW9lZ2xpY2ggYXVzIGRlciB1ZWJlcmdlYmVuZW4gS29uZmlndXJhdGlvbixcbiAgICogc29uc3Qgd2VyZGVuIGRpZSBEZWZhdWx0LVdlcnRlIGdlbnV0enQuXG4gICAqIEBwYXJhbSBsdXhFcnJvclBhZ2VDb25maWdcbiAgICovXG4gIHNldENvbmZpZyhsdXhFcnJvclBhZ2VDb25maWc6IElMdXhFcnJvclBhZ2VDb25maWcpIHtcbiAgICB0aGlzLmVycm9yU3RvcmUuc2FmZU5ld0NvbmZpZyhsdXhFcnJvclBhZ2VDb25maWcpO1xuICAgIC8vIHBvdGVudGllbGxlIGFsdGUgUm91dGUgenUgTHV4RXJyb3JQYWdlQ29tcG9uZW50IGVudGZlcm5lblxuICAgIHRoaXMucm91dGVyLmNvbmZpZyA9IHRoaXMucm91dGVyLmNvbmZpZy5maWx0ZXIoZW50cnkgPT4gZW50cnkuY29tcG9uZW50ICE9PSBMdXhFcnJvclBhZ2VDb21wb25lbnQpO1xuICAgIC8vIG5ldWUgUm91dGUgZWludHJhZ2VuXG4gICAgdGhpcy5yb3V0ZXIuY29uZmlnLnVuc2hpZnQoeyBwYXRoOiB0aGlzLmVycm9yU3RvcmUuY29uZmlnLmVycm9yUGFnZVVybCwgY29tcG9uZW50OiBMdXhFcnJvclBhZ2VDb21wb25lbnQgfSk7XG4gIH1cblxuICAvKipcbiAgICogTmF2aWdpZXJ0IHp1ciBGZWhsZXJrb21wb25lbnRlIHVuZCB2ZXJzdWNodCBlaW5lbiBGZWhsZXJcbiAgICogKHdlbm4gbWl0Z2VnZWJlbikgenUgc2ljaGVybi5cbiAgICogQHBhcmFtIGVycm9yXG4gICAqIEByZXR1cm5zIE9ic2VydmFibGU8YW55PlxuICAgKi9cbiAgbmF2aWdhdGVUb0Vycm9yUGFnZShlcnJvcj86IElMdXhFcnJvcik6IE9ic2VydmFibGU8YW55PiB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aGlzLmVycm9yU3RvcmUuZXJyb3IgPSBlcnJvcjtcbiAgICB9XG4gICAgY29uc3QgeyBlcnJvclBhZ2VVcmwsIHNraXBMb2NhdGlvbkNoYW5nZSB9ID0gdGhpcy5lcnJvclN0b3JlLmNvbmZpZztcbiAgICByZXR1cm4gb2YodGhpcy5yb3V0ZXIubmF2aWdhdGVCeVVybChlcnJvclBhZ2VVcmwsIHsgc2tpcExvY2F0aW9uQ2hhbmdlIH0pKTtcbiAgfVxufVxuIl19